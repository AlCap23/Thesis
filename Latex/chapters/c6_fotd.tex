%!TEX root = ../studentischeArbeiten.tex
\chapter{Control of Simple Multivariable Processes}
\label{c:fotd}

The following chapter gives several examples to decouple a FOTD transfer function matrix. The process is explained with all three method to design multivariable controller. \\

In Sec.\ref{c:fotd:s:analytic} the analytic description of the methods are given, followed by the example taken from literature in Sec. \ref{c:fotd:s:rosenbrook} and Sec.\ref{c:fotd:s:woodberry}.\\

\section{Analytic Decoupling}
\label{c:fotd:s:analytic}

Since a FOTD is the model structure chosen for this work a deeper investigation of transfer function matrices based on this model and the corresponding decoupling algorithms is performed. For the following section a simple two input two output model is defined:

\begin{align}
\begin{split}
\ma{G} = \begin{bmatrix}
g_{11} & g_{12} \\
g_{21} & g_{22}
\end{bmatrix} & ~,g_{ij} = \frac{K_{ij}}{T_{ij} s +1 } e^{-L_{ij}s}
\end{split}
\label{c:fotd:e:examplesys}
\end{align}

For the system described in Eq. \ref{c:fotd:e:examplesys} three different controller based on PI-structure are defined using the methods presented in the previous chapter. Further restrictions on the systems behavior are given by the Maximum Sensitivity $\ma{M}_S$ as a robustness requirement and Maximum Interaction $\ma{H}_{A,Max}$ as a decoupling requirement:

\begin{align}
\begin{split}
\ma{H}_{A,Max} &= \begin{bmatrix}
0 & h_{12,Max} \\
h_{21,Max} & 0 
\end{bmatrix}\\
\ma{M}_{S} &= \begin{bmatrix}
M_{S,1} & 0 \\
0 & M_{S,2}
\end{bmatrix}
\end{split}
\label{c:fotd:e:restrictions}
\end{align}

Eq.\ref{c:fotd:e:restrictions} is given under the assumption that only the diagonal transfer functions are required and the interaction acts on the antidiagonal entries. Furthermore the system will be operating near steady state and hence the frequency used for the RGA analysis and the Taylor Series Expansion is chosen to be $s = 0$.

\subsection{Controller Design via Relative Gain Array Analysis}
\label{c:fotd:su:rga}

To design decentralized controller an adequat pairing has to be chosen and a controller has to be computed by means of a suitable algorithm with the given identified parameters of the transfer function. Using the RGA as an indicator of interaction, the pairing is to be chosen such that the corresponding element $\Lambda_{ij}(\ma{G}_0)$ equals the maximum entry of the row. Assuming a sufficient sorting, the structure of the controller is diagonal as well. The PI controller are designed via the AMIGO algorithm as presented in Sec.\ref{c:controller:s:AMIGO}.\\

Hence, for every pairing $i,j$ the controller parameter are given by:

\begin{align*}
\begin{split}
K_P &= \frac{0.15}{\hat{K}}+ \left(0.35 - \frac{\hat{L}+\hat{T}}{(\hat{L}+\hat{T})^2}\right) \frac{\hat{T}}{\hat{K}\hat{L}} \\
T_I &= 0.35 \hat{L} + \frac{13 \hat{L}\hat{T}^2}{\hat{T}^2 + 12 \hat{L}\hat{T} + 7 \hat{L}^2}
\end{split}
\end{align*}

With a minimum requirement for the delay of $\hat{L} \geq 0.3 \hat{T}$. The setpoint-weight is chosen according to the normalized time delay $\tau = \frac{\hat{L}}{\hat{L}+\hat{T}}$:

\begin{align*}
b = \begin{cases}
\begin{split}
0 &, \tau < 0.2 \\
10(\tau-0.2) &, 0.2 \leq \tau \leq 0.3 \\
1.0 &, \tau \geq 0.3
\end{split}
\end{cases}
\end{align*}


\subsection{Controller Design via Astr\"om et. al.}
\label{c:fotd:su:astrom}

At first the decoupler is designed via the inverse static gain of the system, since the error connected to the steady state measurement can be assumed small with respect to the dynamic error. Hence, the decoupler is given by:

\begin{align}
\begin{split}
\ma{D} &= \ma{G}_0^{-1}\\
&= \frac{1}{K_{11}K_{22}-K_{12}K_{21}} 
\begin{bmatrix}
K_{22} & -K_{21} \\
-K_{12} & K_{11}
\end{bmatrix} \\
&= \frac{1}{\det(\ma{G}_0)} 
\begin{bmatrix}
K_{22} & -K_{21} \\
-K_{12} & K_{11}
\end{bmatrix}
\end{split}
\label{c:fotd:e:exampleDecoupler}
\end{align}

The transformed system $\ma{G}^*$ can thus be calculated as

\begin{align}
\begin{split}
\ma{G}^* &= \ma{G}\ma{D}\\
&= \frac{1}{\det(\ma{G}_0)} 
\begin{bmatrix}
g_{11} & g_{12} \\
g_{21} & g_{22}
\end{bmatrix}
\begin{bmatrix}
K_{22} & -K_{21} \\
-K_{12} & K_{11}
\end{bmatrix} \\
&= \frac{1}{\det(\ma{G}_0)}
\begin{bmatrix}
K_{22}g_{11}-K_{12}g_{12} & -K_{21}g_{11}+K_{22}g_{12} \\
K_{22}g_{21}-K_{12}g_{22} &
-K_{21}g_{21}+K_{11}g_{22}
\end{bmatrix}
\end{split}
\label{c:fotd:e:exampletransformed}
\end{align}

From Eq. \ref{c:fotd:e:exampletransformed} it is clear that the entries $g_{ij}^*$ are linear combinations of FOTD transfer functions. Due to the properties of the exponential function the superposition principle does not hold. Hence a controller via the AMIGO algorithm can only be designed if a sufficient approximation of the linear combination as a FOTD can be formulated:

\begin{align}
\begin{split}
g_{ij}^* & = \frac{K_{ij}^*}{T_{ij}^*s+1}e^{-L_{ij}^* s} + \Delta g_{ij}^*\\
&\approx \frac{K_{ij}^*}{T_{ij}^*s+1}e^{-L_{ij}^* s} 
\end{split}
\label{c:fotd:e:exampleFOTDapprox}
\end{align}

Within Eq. \ref{c:fotd:e:exampleFOTDapprox} the main drawback of the method is layed out. As stated earlier, most algorithms for PI(D) design rely on a fixed model structure and hence are not fit to process information given by a combination. To use the function, two methods are proposed to approximate the linear combination of FOTD.\\

Assuming the results of the experiment used for identifying the process are still avaible the process approximate model can be found via a weighted sum of the systems output. Calculating the static can as proposed in Ch.\ref{c:identification}, the linear combination of the TITO system can be fitted to the resulting weighted measurement data, e.g. given by

\begin{align}
\begin{split}
y_{11}^*(t) &= \frac{K_{22} y_{11}(t) - K_{12} y_{12}(t)}{\det(\ma{G}_0)}
\end{split}
\label{c:fotd:e:Combination}
\end{align}

Eq. \ref{c:fotd:e:Combination} reuses the experimental data to approximate the systems output. $y_{ii}$ is the i-th output of the system reacting to excitation via the i-th input. With the weighted data given by $y_{11}^*$, a FOTD model could be fitted according to the already known algorithm presented in Ch. \ref{c:identification}. However, this approach is limited to the reuse of data and requires that the process is always weighted by a decoupler.\\

The second method relies on knowledge about the behaviour of the transfer functions in the time domain. At first, the static gain is given by:

\begin{align}
\begin{split}
\ma{K}^* &= \lim_{s\mapsto 0} \ma{G}^* \\
&= \ma{K} ~\ma{D} \\
&= \ma{I}
\end{split}
\label{c:fotd:e:CombinationGain}
\end{align}

The integral of every part of the experiment, given by a matrix $\ma{Y} = (y_{ij}) \in \mathbb{R}^{n_y \times n_y}$ and its transformed counterpart can be rewritten as

\begin{align}
\begin{split}
\int_0^\infty \ma{Y}^*(\infty) - \ma{Y}^*(t) dt &= \int_0^\infty \ma{Y}(\infty) - \ma{Y}(t) dt ~\ma{D} \\
\ma{K}^* \circ \ma{T}_{ar}^{*} &= \ma{K}^* \circ \left( \ma{T}^* + \ma{L}^* \right) \\
&= \left(\ma{K} \circ \left( \ma{T} + \ma{L} \right) \right) \ma{D}\\
\end{split}
\label{c:fotd:e:CombinationIntegral}
\end{align}

Where $\circ$ denotes the element wise multiplication, also called Hadamard Product. It gives the transformed average residence times $\ma{T}_{ar}^*$. Since the Hadamard Product relates to the row and column sum, one can rewrite the transformed average residence time for a static decoupler as

\begin{align}
\begin{split}
\sum_{i = 1}^{n_y} \left[ \left(\ma{K} \circ \left( \ma{T} + \ma{L} \right) \right) \ma{D} \right]_{i,j} &= \left[\left(\left( \ma{T} + \ma{L} \right)^T \ma{K}^T \right) \ma{D} \right]_{j,j}\\
&= \left[\left(\left( \ma{T} + \ma{L} \right)^T \right) \ma{K}^T  \ma{K}^{-1} \right]_{j,j}\\
&= \left[\left( \ma{T} + \ma{L} \right)^T \ma{\Lambda}^T\left( \ma{G} \right) \right]_{j,j} 
\end{split}
\label{c:fotd:e:AverageResidenceTime_Transform}
\end{align}
 
Eq. \ref{c:fotd:e:AverageResidenceTime_Transform} relates the approximation to the RGA as given in Ch. \ref{c:controller}. Hence, if the influence of the minor diagonals is small, the approximation is sufficiently good.\\

To determine the coefficients of the new system a third equation is needed. It is convinient to choose an appropriate value for the new time delay $L^*$ with several options like a weighted sum, the minimum or maximum of all involved delays. A robust method is given by choosing the maximum and hence implement a conservative tuning. Subsequently Eq. \ref{c:fotd:e:CombinationIntegral} can be rearranged to

\begin{align}
\begin{split}
\ma{T}^* &= \ma{T}_{ar}^* - \ma{L}^* \\
&= \ma{T}_{ar}^* - \ma{L}_{Max} 
\end{split}
\label{c:fotd:e:CombinationTimeConstant}
\end{align}

Assuming an approximation can be found and the resulting error is sufficiently small the diagonal controller can be designed. Since the main coupling are always on the main diagonal, the RGA has not to be performed. The single, decentralized controllers are design as explain earlier by the use of the AMIGO Tuning rules. A controller is then given by:

\begin{align}
\begin{split}
\ma{K}_y^* &= \begin{bmatrix}
-K_{P1}^* - K_{I1}^*\frac{1}{s} & 0 \\
0 & -K_{P2}^* - K_{I2}^*\frac{1}{s}
\end{bmatrix} \\
\ma{K}_r^* &= \begin{bmatrix}
b_1~K_{P1}^* + K_{I1}^*\frac{1}{s} & 0 \\
0 & b_2~K_{P2}^* + K_{I2}^*\frac{1}{s}
\end{bmatrix} 
\end{split}
\label{c:fotd:e:exampleTransformedControler}
\end{align}

%\begin{figure}[h]
%  \centering
%  \def\svgwidth{\textwidth}
%  \input{./Graphics/Area_Linear_Combination.pdf_tex}
%\end{figure}

With parameters $K_{P,i},K_{I,i} \in \mathbb{R}$ are calculated via the AMIGO tuning rules as described in Sec.\ref{c:controller:s:AMIGO}. Since the approximation given in Eq.\ref{c:fotd:e:exampleFOTDapprox} holds an inevitable error so do the parameter. \\

Next, the interaction will be used to detune the controller. The first order term of the Taylor series of the antidiagonal entries of the system $\ma{G}^* = \ma{G} \ma{D}$ is given by:

\begin{align}
\begin{split}
\ma{\Gamma}_A &= \left[\frac{d}{ds}\ma{G}|^*_{s=0}\right]_A s \\
&= \frac{1}{\det(\ma{G}_0)}~\begin{bmatrix}
0 & -K_{21}K_{11}(T_{11}-L_{11}) + K_{22}K_{12}(T_{12}-L{12}) \\
-K_{12}K_{22}(T_{22}-L_{22}) + K_{22}K_{21}(T_{21}-L_{21}) & 0
\end{bmatrix} s\\
&\approx \begin{bmatrix}
0 & K_{12}^* (T_{12}^* - L_{12}^*) \\
K_{21}^* (T_{21}^* - L_{21}^*) & 0 
\end{bmatrix} s
\end{split}
\label{c:fotd:e:exampleTransformedCoupling}
\end{align}

From Eq. \ref{c:fotd:e:exampleTransformedCoupling} the dependency of the coupling on the both the static gain of the system and the dynamical behaviour can be observed. This coincides with the statements of \cite{Lunze2014} declaring that static decoupling is in general easier if the dynamic behaviour of the involved transfer functions is similar.\\

Detuning the controller with the constrains on the closed loop given by Eq. \ref{c:fotd:e:restrictions} and solving Eq. \ref{c:controller:e:Hmax*} for the controller with setpoint holds:

\begin{align}
\begin{split}
\ma{K}^*_r &\leq \ma{\Gamma}^{-*}_{A,Max}\ma{M}_S^{-1}\ma{H}^*_{A,Max} \\ 
&\leq \frac{1}{\det(\ma{M}_S)}\ma{\Gamma}^{-*}_{A,Max}\ma{H}^*_{A,Max}\\
&\leq \frac{1}{M_{S,1}M_{S,2}}
\begin{bmatrix}
\frac{h_{21,Max}}{K_{12}^* (T_{12}^* - L_{12}^*)} & 0\\
0 & \frac{h_{12,Max}}{K_{21}^* (T_{21}^* - L_{21}^*)} 
\end{bmatrix}
\end{split}
\end{align}

A detuning of the controller parameter is performed according to the detuning rules given in Sec.\ref{c:controller:s:AMIGO} to ensure the controller is within the limits specified earlier.

\subsection*{Controller Design via Modified Astr\"om}

Now the modified algorithm proposed in this thesis is applied to the same system. First, we design the controller as a function of the main diagonal entries $g_{ii}$ once again using the AMIGO tuning rules:

\begin{align}
\begin{split}
\ma{K}_y &= \begin{bmatrix}
-K_{P1} - K_{I1}\frac{1}{s} & 0 \\
0 & -K_{P2} - K_{I2}\frac{1}{s}
\end{bmatrix} \\
\ma{K}_r &= \begin{bmatrix}
b_1~K_{P1} + K_{I1}\frac{1}{s} & 0 \\
0 & b_2~K_{P2} + K_{I2}\frac{1}{s}
\end{bmatrix}
\end{split}
\label{c:fotd:e:exampleControler}
\end{align}

The splitter $\ma{\Sigma}$ is likewise designed by the steady state of the system as:

\begin{align}
\begin{split}
\ma{\Sigma} &= \ma{D}_A\ma{D}_D^{-1} \\
& = \begin{bmatrix}
0 & -\frac{K_{12}}{K_{11}} \\
-\frac{K_{21}}{K_{22}} & 0
\end{bmatrix}
\end{split}
\end{align}

To test for interaction define the maximum interaction and the sensitivity like in Eq. \ref{c:fotd:e:restrictions}. The anti diagonal parts of the Taylor series can be calculated to be

\begin{align}
\begin{split}
\ma{\Gamma}_A &= \frac{d}{ds}\left[\ma{G}_A + \ma{G}_D\ma{\Sigma}\right]|_{s=0} \\
&= \begin{bmatrix}
0 & K_{12}(T_{12}-L_{12}) - K_{11}\frac{K_{12}}{K_{11}}(T_{11}-L_{11}) \\
K_{21}(T_{21}-L_{21}) - K_{22}\frac{K_{21}}{K_{22}}(T_{22}-L_{22}) & 0 
\end{bmatrix} \\
&= \begin{bmatrix}
0 & K_{12}(T_{12}-L_{12} - T_{11}+L_{11}) \\
K_{21}(T_{21}-L_{21} - T_{22}+L_{22}) & 0 
\end{bmatrix} 
\end{split}
\end{align}

To detune the controller solving Eq. \ref{c:controller:e:Hmax*} with for the controller as before holds:

\begin{align}
\begin{split}
\ma{K}_R &\leq \ma{\Gamma}_A^{-1} \ma{M}_S^{-1} \ma{H}_{A,Max} \\
&\leq \frac{1}{\det(\ma{M}_S)} \ma{\Gamma}_A^{-1} \ma{H}_{A,Max} \\
&\leq \frac{1}{M_{S,1}M_{S,2}}\begin{bmatrix}
\frac{h_{12,Max}}{K_{12}(T_{12}-L_{12}-T_{11}+L_{11})} & 0 \\
0 &\frac{h_{21,Max}}{K_{21}(T_{21}-L_{21}-T_{22}+L_{22})}
\end{bmatrix}
\end{split}
\end{align}

The system is detuned according to the detuning rules of the AMIGO algorithm. In contrast to Astr\"oms decoupling algorithm, the original system is used the original structure of the model is preserved.

\newpage
\section{Rosenbrocks Function}%
\label{c:fotd:s:rosenbrook}

First, the example of Rosenbrock's Function will be considered. The system is given by

\begin{align}
\begin{split}
\ma{G} &= \begin{bmatrix}
\frac{1}{s+1} & \frac{2}{s+3} \\
\frac{1}{s+1} & \frac{1}{s+1}
\end{bmatrix}
\\
&=\begin{bmatrix}
\frac{1}{s+1} & \frac{\frac{2}{3}}{\frac{1}{3}s+1} \\
\frac{1}{s+1} & \frac{1}{s+1}
\end{bmatrix} 
\end{split}
\label{c:fotd:e:rosenbrock_sys}
\end{align}

The transfer function matrix given in Eq.\ref{c:fotd:e:rosenbrook_sys} is delay free. The systems time constants and gains are equal for the transfer functions for the input-output pairing  $(u_1, y_1)$,$(u_1,y_2)$ and $(u_2,y_1)$ all equal $T = \unitfrac[1]{sec}{rad}$ and $K = 1$. The transfer function from input 2 to output 1 has a time constant $T = \unitfrac[\frac{1}{3}]{sec}{rad}$ and a gain of $K = \frac{2}{3}$. Hence,whilst not as influencial with respect to gain, $g_{21}$ is acting faster on $y_1$ than $g_{11}$.\\ 

Rosenbrock's system is a common example. As stated in \cite{Astrom2001a}, it looks easy to control but is not stable, since its characteristic equation given in Eq. \ref{c:fotd:rosenbrock_chareq} has a pole in the right half plane at $s=1$.

\begin{align}
\begin{split}
\det\left( \ma{G} \right) &= \frac{1}{\left( s + 1\right)^2} - \frac{2}{\left( s + 1\right) \left( s + 3\right)}
\end{split}
\label{c:fotd:rosenbrock_chareq}
\end{align}

The system is used as an example in \cite{Astrom2001a}, where a controller has been computed using analytical methods. This controller will serve as a reference to the methods developed in Ch. \ref{c:controller}. 

\subsection{Decentralized Controller}%
\label{c:fotd:s:rosebrock:sub:decentral}

To determine the system input-ouput pairing the RGA of Eq.\ref{c:fotd:e:rosenbrock_sys} at steady state is computed to be:

\begin{align}
\begin{split}
\Lambda(\ma{G})_0 &= \begin{bmatrix}
3 & -2 \\
-2 & 3
\end{bmatrix} 
\end{split}
\label{c:fotd:e:rosenbrock_rga}
\end{align}

The result of Eq.\ref{c:fotd:e:rosenbrock_rga} advices to control the process using the main diagonal of the system. Following this advice, one is able to design the decentralised controller via the AMIGO tuning rules given in Sec. \ref{c:controller:s:AMIGO}. Designing a PI controller by Eq. \ref{c:controller:e:amigo_pi} with the system coefficients gives a diagonal controller with

\begin{align}
\ma{K} &= \ma{K}_P + \frac{1}{s}~ \ma{K}_I\\
&= \begin{bmatrix}
0.725 & 0 \\
0 & 0.725
\end{bmatrix}
+ \frac{1}{s}\begin{bmatrix}
0.852 & 0 \\
0 & 0.852
\end{bmatrix}
\end{align}

With a set-point weight of $ b = 0 $, since the normalized time delay $\tau_{ij} = 0 ~\forall i,j \in [1,2]$. The parameter of the controller have been computed using an artificial delay of $L = 0.3~T$, since it enables a more robust tuning.

\subsection{Decoupled Controller based on Astr\"om}%
\label{c:fotd:s:rosebrock:sub:astrom}

At first, the decoupler $\ma{D}$ is designed based on the steady state gain to be 

\begin{align}
\begin{split}
\ma{D} &= \begin{bmatrix}
3 & -2 \\
-3 & 3
\end{bmatrix}
\end{split}
\label{c:fotd:s:rosenbrock:eq:ast_decoupler}
\end{align}

This results in the transformed system $\ma{G}^*$ as given in \cite{Astrom2001a}:

\begin{align}
\begin{split}
\ma{G}^* &= \ma{G} ~\ma{D} \\
&= \begin{bmatrix}
\frac{3\left(1-s\right)}{\left(s+1\right)\left(s+3\right)} & \frac{4~s}{\left(s+1\right)\left(s+3\right)} \\
0 &   \frac{1}{s+1}
\end{bmatrix}
\end{split}
\label{c:fotd:s:rosenbrock:eq:ast_transformed}
\end{align}

From Eq.\ref{c:fotd:s:rosenbrock:eq:ast_transformed} it is easy to see that the influence of input 1 to output 2 is already decoupled. The interaction is therefore zero. This relies on the similarities of the dynamics of $g_{12}$ and $g_{22}$. The first order linearization of $g_{21}^*$ holds:

\begin{align}
\begin{split}
\gamma_{12} &= \frac{d}{ds}\left(g_{21}^*\right) |_{s=0} \\
&= \frac{4}{3}
\end{split}
\label{c:fotd:rosenbrock:eq:ast_interaction}
\end{align}

To design a controller based on the simple tuning rules, the main diagonal transfer functions of the system Eq.\ref{c:fotd:s:rosenbrock:eq:ast_transformed} have to be estimated with a FOTD model. According to Eq. \ref{c:fotd:e:CombinationIntegral}, one can estimate the influence the linear combination of the FOTD model via:

\begin{align}
\begin{split}
\ma{K}^* \circ \ma{T}_{ar}^{*} &= \ma{K}^* \circ \left( \ma{T}^* + \ma{L}^* \right)\\
&=  \left( \ma{K} \circ \left[ \ma{T} + \ma{L} \right] \right) \ma{D} \\
&= \begin{bmatrix} 
2.330 & -1.335 \\ 
0.003 & 0.977	
\end{bmatrix}
\end{split}
\label{c:fotd:s:rosenbrock:eq:ast_approx}
\end{align}


Which is consisting of the steady state gain $\ma{K}^* = \ma{I}$ and the approximate lag of:

\begin{align}
\begin{split}
\ma{T}^* & = \ma{T}_{ar}^* - \underbrace{{\ma{L}}}_{0}^* \\
&= \ma{T}_{ar}^*
\end{split}
\label{c:fotd:s:rosenbrock:eq:ast_lag_approx}
\end{align}

Hence, the approximated, diagonal system is given by 

\begin{align}
\begin{split}
\ma{G}_D^* &\approx \begin{bmatrix}
\frac{1}{2.330~s+1} & 0 \\
0 & \frac{1}{0.977~s+1}
\end{bmatrix}
\end{split}
\label{c:fotd:s:rosenbrock:eq:ast_diag_sys}
\end{align}

The transfer function $g_{22}$ of the approximated system given in Eq.\ref{c:fotd:s:rosenbrock:eq:ast_diag_sys} is almost identical with its real counterpart in Eq.\ref{c:fotd:s:rosenbrock:eq:ast_transformed}. The difference of the first main diagonal entry is however, much more significant. A bode plot of both systems hold\\

FIGURE\\

From FIG the conservative character of the approximation can be seen. With regards to the design of a PI controller this results in a more aggressive, more faster controller than the controller based on RGA, since $K_P,~T_I \propto \frac{1}{T}$. The controller calculated for the diagonal system is given by:

\begin{align}
\ma{K} &= \ma{K}_P + \frac{1}{s}~ \ma{K}_I\\
&= \begin{bmatrix}
0.725 & 0 \\
0 & 0.725
\end{bmatrix}
+ \frac{1}{s}\begin{bmatrix}
0.363 & 0 \\
0 & 0.852
\end{bmatrix}
\end{align}

 The set-point weight for the proportional gain is $b = 0$ since $\tau_{ij} = 0 ~\forall i,j \in [1,2]$. From the integral gain of the first loop we see the conservative estimation of the approximation.\\

 For the detuning an upper limit regarding the interaction of the process is required. Since a minimal interaction is desired, the upper limit of the interaction is set to $h_{ij} = 0.3 ~ \forall i,j \in [1,2]$. Iterative detuning of the controller with a decay of $\frac{K_P^{i+1}}{K_P^{i}} = 0.9 $ changes the parameter value to be:

\begin{align}
\ma{K} &= \ma{K}_P + \frac{1}{s}~ \ma{K}_I\\
&= \begin{bmatrix}
0.725 & 0 \\
0 & 0.015
\end{bmatrix}
+ \frac{1}{s}\begin{bmatrix}
0.363 & 0 \\
0 & 0.108
\end{bmatrix}
\end{align}

After 45 iterations. The impact of the strong coupling of the second input to the first output of the system is clearly visible in the number of iterations. The controller $k_{R,11}$ is tuned to be much less aggressive than its original designed predecessor.


\subsection{Decoupled Controller based on Robust Relative Dynamic Detuning}
\label{c:fotd:s:rosenbrock:ss:modifiedastr}

Since the process until the detuning is nearly identical to the controller design by a simple RGA analysis previously, these steps are not discussed. The decoupler of the process is given as the ration of the diagonal and anti-diagonal entries as:

\begin{align*}
\begin{split}
\ma{\Sigma} &= \begin{bmatrix}
0 & -\frac{\frac{2}{3}}{1} \\
-\frac{1}{1} & 0
\end{bmatrix}
\\
&= \begin{bmatrix}
0 & -0.667 \\
-1.000 & 0
\end{bmatrix}
\end{split}
\end{align*}

The relative dynamic interaction acting on the process are given from $u_2$ to $y_1$:

\begin{align*}
\begin{split}
\gamma_{R,12} &= \left|\frac{K_{12} \left( T_{12} + L_{12}  - T_{11} - L_{11} \right)}{K_{11} \left( T_{11} + L_{11}\right)} \right| \\
&= \left|\frac{\frac{2}{3} \left( 1  - \frac{1}{3} \right)}{1 \left( 1\right)} \right| \\
&= \frac{2}{3} ~\frac{2}{3}\\
&= \frac{4}{9}
\end{split}
\end{align*}

Within the same limitations for the controller, namely $h_{ij} = 0.3 ~ \forall i,j \in [1,2]$, the dynamically detuned controller is given by:

\begin{align*}
\ma{K} &= \ma{K}_P + \frac{1}{s}~ \ma{K}_I\\
&= \begin{bmatrix}
0.725 & 0 \\
0 & 0.058
\end{bmatrix}
+ \frac{1}{s}\begin{bmatrix}
0.852 & 0 \\
0 & 0.324
\end{bmatrix}
\end{align*}

After 24 iterations and a shrinking rate of $\frac{K_P^{i+1}}{K_P^{i}} = 0.9 $. While reflecting the detuning with respect to the purely decentralized controller of the RGA, it is much more aggressive than the controller designed by the previous decoupling algorithm. \\

\subsection{Results}
\label{c:fotd:s:rosenbrocks:ss:results}

To evaluate the performance of the controller, a simulation has been performed. As a reference, the decoupled controller presented by \cite{Astrom2001a} for the same process with the following parameters has been added as well:

\begin{align*}
\ma{K} &= \ma{K}_P + \frac{1}{s}~ \ma{K}_I\\
&= \begin{bmatrix}
0.245 & 0 \\
0 & -0.452
\end{bmatrix}
+ \frac{1}{s}\begin{bmatrix}
0.248 & 0 \\
0 & 0.075
\end{bmatrix}
\end{align*}

The controller has been designed using analytical methods. It has a setpoint-weight of $b_i = 0, \forall i \in [1,2]$.\\

To see the effect of the decoupler, at first the system is simulated without the detuned controller.  The initial output is set to zero $\ve{y}_0 = \ve{0}$ and at $t = 0~s$ a jump on the reference value $y_{R,1}$ is given. When the system is in a steady state, at $t = 100~s$, the reference value for the second output is set to $y_{R,2} = 1$. The results for all three controller are presented in Fig.\ref{c:fotd:s:rosenbrock:f:SimNonDetuned}. The response of the reference controller is in dashed grey, while the decentralized controller is colored blue, the decoupled controller designed as proposed by Astr\"om is red and the robust relative dynamic detuned controller is given in orange.\\

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Rosenbrock_NotDetuned.svg}
\caption{Simulation of Rosenbrock's System without detuning}
\label{c:fotd:s:rosenbrock:f:SimNonDetuned}
\end{figure}

The performance measurements are given in Tab.\ref{c:fotd:s:rosenbrock:tab:eval1}. The rising time $T_{Rise} \in \mathbb{R}^+$, the overshoot $m_p \in \mathbb{R}^+$ and the settling time $T_{Settle} \in \mathbb{R}^+$ describe the tracking performance of the controller. The rising time describes how fast a controller is able to increase the output from $10\%$ to $90\%$ of the steady state output. The overshoot describes the maximum of the output after it reaches the steady state value for the first time. The settling time measures the time interval which is necessary for the output to stay within $\left(100 \pm 2\right)\%$ of the steady state output. Likewise the performance indicators regarding the disturbance rejection are defined. Only the overshoot time $T_P \in \mathbb{R}^+$ is new and gives the time of the maximum overshoot with respect to the signals occurrence. 

\begin{table}[H]
\centering
\caption{Evaluation of tracking performance and disturbance rejection performance of Rosenbrock's system without detuning}
\label{c:fotd:s:rosenbrock:tab:eval1}
\input{./Graphics/Rosenbrock_NotDetuned_StepInfo}
\end{table}
It can be seen that while the decentralized controller is acting fast on its main coupling, the impact due to the coupling of the excited input and the coupled output of $y_2$ is exalted. The overshoot of the cross coupled output is nearly $m_{\Delta}(y_2) = 0.46$, while both decoupled controllers are able to suppress the interaction completly. This behavior is induced due to the similar dynamics of the the transfer functions $g_{12}$ and $g_{22}$. Since both gain and time constant are equal, a simple interconnection is able to completly cancel out the negative effects of the first input excitation.\\

Observing the input response an undershoot of both decoupled controllers can be seen. This origins in the stationary estimation of the decoupler, which acts instantly and corrects with the full strength of the ratio of the steady state gains. Hence, the signal given onto the second input of the system acts at first to progressive. It is noteworthy that while both the decentralized controller and the controller in combination with the splitter are equal, the last of both is acting faster. This is another effect caused by the decoupling, since the controller does not have to adjust to disturbances due to the systems second output. It can also be observed in weaker form on the fully static decoupler, given as proposed by Astr\"om.\\

With respect to the reference controller introduced in \cite{Astrom2001a}, the auto-tuned controller show nearly identical behavior.\\

The second output response to a step of its reference value gives interesting results as well. Since both transfer functions acting on the output behave identical with respect to gain and dynamic, the undershoot observed in the second output is missing. Additionally, the controller tuned via the decoupling method proposed by Astr\"om et. al. is clearly acting the fastes referring to input response. The positive effect of the splitter exists but is much weaker than before. Hence, the controller is not notably faster than the decentralized controller.\\

A clear picture is given by the disturbance acting on the first ouput $y_1$ due to the excitation of $u_2$. The magnitude of the overshoot of the decoupled controller designed with a static decoupler is even worse than its non-decoupled counterpart, reaching nearly $m_{\Delta}(y_1) = 0.55$. Since the gains of the system are captured well, the reason for this effect can be found in the controller designed by the analogous model. Since the approximated time constant is twice as much as its original, the controller is not able to act fast enough on the disturbance. Additionally, it amplifies the effect since the processes $g_{11}$ and $g_{12}$ differ from each other dynamically. Afterwards the controller tries to counter the effect and undershoots its target value before slowly reaching a steady state once again.\\

Oppose to that, the decentralized controller acts more reasonable, slowly reducing the error of the output on a monotone decreasing track. The controller in combination with the splitter reduces the effect of the coupling immensely, but shows small undershoots due to the same reasons as mentioned beforehand. However, it is acting smoother and less drastically than the decoupler based on the static inverse. The reference controller shows only slight influences due to the disturbance and limits the overshoot to $\Delta y_1 = 0.11$. This is reasonable, since it is designed and detuned for that limitation.\\

Regarding the robustness and the tracking performance, the singular values of the closed loops sensitivity and complementary sensitivity have been calculated. The results can be seen in Fig.\ref{c:fotd:s:rosenbrock:f:SingVal}.\\

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Rosenbrock_NotDetuned_SV.svg}
\caption{Singular values of the sensitivity (red) and complementary sensitivity (green) function of Rosenbrock's system without detuning}
\label{c:fotd:s:rosenbrock:f:SingVal}
\end{figure}


The decentralized controller performs reasonable well. Its maximum singular value of the sensitivity is given by $\overline{\sigma} = 1.25$ at the frequency of $\omega = 0.60 ~rad/s$. The process is robust within the frequencies lower than $\omega \leq 0.22$, since this is the first time that the sensitivity exceeds the limit of $\overline{\sigma} \geq 1$. Likewise, the processes tracking performance begins to decrease at that frequency. Until that frequency is reached, the singular values are nearly identical and have a gain of 0 dB, which corresponds to an evenly distributed tracking performance of both outputs. \\

The singular values of the decoupling controller as proposed by Astr\"om differ strongly. The maximum singular value of the sensitivity reaches its peak at a frequency of $\omega = 1.91 ~rad/s$ with a magnitude of $\overline{\sigma} = 3.40$. Hence, a more robust complementary sensitivity function with respect to the bandwidth is given. The maximum singular value exceeds 0 dB around a frequency of $\omega = 0.5 rad/s$, which is much higher than the frequency range of the decentralized controller. However, the lower value of the complementary sensitivity decreases faster at hence the outputs are not controllable evenly.\\

At last, the controller designed by robust relative dynamic decoupling is investigated with respect to its sensitivity and complementary sensitivity. The peak of the sensitivity is given with $\overline{\sigma} = 1.59$ at a frequency of $\omega = 0.88 ~rad/s$. It can be seen that while the decoupler widens the useable frequency range it also amplifies the maximum singular value of the sensitivity function. Furthermore, until the frequency of $\omega = 0.30 ~rad/s$, the singular values are very evenly distributed. This indicates the effect of the decoupler with respect to tracking efficiency and the distribution of noise or disturbances.\\

Next, the controller are detuned for a maximum interaction of $h_{A,Max} \leq 0.3$. The simulation results are shown in Fig.\ref{c:fotd:s:rosenbrock:f:SimDetuned} with the same color coding as before. The performance evaluation is given in Tab.\ref{c:fotd:s:rosenbrock:tab:eval2}\\

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Rosenbrock_Detuned.svg}
\caption{Simulation of Rosenbrock's System with detuning}
\label{c:fotd:s:rosenbrock:f:SimDetuned}
\end{figure}

\begin{table}[H]
\centering
\caption{Evaluation of tracking performance and disturbance rejection performance of Rosenbrock's system with detuning}
\label{c:fotd:s:rosenbrock:tab:eval2}
\input{./Graphics/Rosenbrock_Detuned_StepInfo}
\end{table}

In comparison to the not-detuned closed loop, both decoupled controller show a less aggressive performance as a result of the much lesser values for the proportional and integral gain. This is visible from the step response of the second output $y_2$, where rising times have increased.Likewise, the detuning reduces the interaction largely. Both decoupled controller have a maximum overshoot of $\Delta y_{1} \leq 0.11$.\\

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Rosenbrock_Detuned_SV.svg}
\caption{Singular values of the sensitivity (red) and complementary sensitivity (green) function of Rosenbrock's system with detuning}
\label{c:fotd:s:rosenbrock:f:SingValDetuned}
\end{figure}

The singular values of the decoupled controller designed by Astr\"om  also changed, as can be seen in Fig.\ref{c:fotd:s:rosenbrock:f:SingValDetuned}. While the frequency where the maximum singular value of the sensitivity function occurs changed only little from $\omega = 1.91~rad/s$ to $\omega = 1.94 rad/s$, the magnitude has decreased to $\overline{\sigma} = 2.61$. But, due to the less aggressive and hence less effective controller, the crossing point of the maximum singular value changed to a lower frequency  of $\omega = 0.22~rad/s$. Hence, the tracking performance of the controller has a smaller bandwidth than before.\\

The controller designed by means of R2D2 is not significantly influenced, as can be seen in FIG. Both the frequency of the maximum singular value of the sensitivity and the magnitude change little, given by $\omega = 0.87 rad/s$ and $\overline{\sigma} = 1.48$. Opposed to the not detuned controller, a broader spread of the singular values of the sensitivity can be seen. Hence, the tracking performance is already decreasing at lower frequencies, as can be seen from the lower singular value of the complementary sensitivity function. However, the bandwidth of the controller, limited by $\omega = 0.22 rad/s$, is nearly identical to before.\\

\newpage
\section{Wood-Berry's Binary Distillation Column}%
\label{c:fotd:s:woodberry}

As a second example the model of a binary distillation column, introduced by Wood and Berry REFERENZ, and used throughout academia, e.g. \cite{Astrom2001a}, RGAMEASURES, \cite{Skogestad2005}, will be investigated.\\

The model is given by the following transfer matrix, consisting of FOTD models:

\begin{align*}
\ma{G} = \begin{bmatrix}
\frac{12.8}{16.7 ~s+1}~e^{-s}  & \frac{-18.9}{21.0 ~s+1}~e^{-3s}\\
\frac{6.6}{10.9 ~s+1}~e^{-7s} & \frac{-19.4}{14.4 ~s+1}~e^{-3s}
\end{bmatrix}
\end{align*} 

Since the system is under the effect of time delay, the dynamics will be influenced from the average residence time $T_{ar} = T + L$ instead of a pure time constant in the previous section. The processes normalized time is given as following:

\begin{align*}
\ma{\tau} = \begin{bmatrix}
\frac{1}{16.7+1} & \frac{3}{21.0+3} \\
\frac{7}{10.9+7} & \frac{3}{14.4+3}
\end{bmatrix} \approx \begin{bmatrix} 
0.056 & 0.125 \\
0.391 & 0.172
\end{bmatrix}
\end{align*}
Which indicates that most of the transfer functions involved can be controlled without much effort. Only the entry $\tau_{12} \approx 0.391$ is challenging, since the delay has much influence on the outputs behavior. Due to these mixed normalized times, the effectiveness of the AMIGO algorithm in presence delays can be seen. Furthermore, the effectiveness of the decoupler in presence of delays is to be investigated. At first, the identification is performed. The identified system is given by:

\begin{align*}
\hat{\ma{G}} = \begin{bmatrix}
\frac{12.800}{16.684 ~s+1}~e^{-1.016s}  & \frac{-18.899}{20.984 ~s+1}~e^{-3.014s}\\
\frac{6.600}{10.901 ~s+1}~e^{-7.005s} & \frac{-19.400}{14.384 ~s+1}~e^{-3.014s}
\end{bmatrix}
\end{align*} 

Since the values are given by a noise free, numerical simulation it is obvious that the identification will perform less optimal in a real environment. Nonetheless, the precision of the method can be seen from the values of the parameter.\\

The RGA analysis of the system in steady state gain computes to be:

\begin{align*}
\ma{\Lambda}(\ma{G}_0) = \begin{bmatrix}
2.01 & -1.01 \\
-1.01 & 2.01
\end{bmatrix}
\end{align*} 

Which indicates the diagonal pairing $u_1 \mapsto y_1~, u_2 \mapsto y_2$. Oppose to Sec.\ref{c:fotd:s:rosenbrook}, the process of designing the controller will not be explained in its entirety. The parameter for the decentralized control, the decoupling controller based on Astr\"om and the R2D2 are listed in the TABLE!! below for both a not detuned and detuned case.\\

TABLE\\

The static decoupler and the splitter are given as:

\begin{align*}
\ma{D} = \begin{bmatrix}
0.167 & -0.153 \\
0.053 & -0.104
\end{bmatrix}, \ma{\Sigma} = \begin{bmatrix}
0 & 1.476 \\
0.340 & 0
\end{bmatrix}
\end{align*}

Simulation of the system without detuning, hence representing the effect of the decoupler and splitter, is shown in Fig. \ref{c:fotd:s:woodberry:f:SimNotDetuned}. As before, a reference controller \cite{Astrom2001a} with computational optimized parameters is simulated as well. The performance evaluation is given below in Tab. \ref{c:fotd:s:woodberry:tab:eval1}.

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Woodberry_NotDetuned.svg}
\caption{Simulation of Wood-Berry's binary distillation column without detuning}
\label{c:fotd:s:woodberry:f:SimNotDetuned}
\end{figure}

\begin{table}[H]
\centering
\caption{Evaluation of tracking performance and disturbance rejection performance of Wood-Berry's binary distillation column without detuning}
\label{c:fotd:s:woodberry:tab:eval1}
\input{./Graphics/Woodberry_NotDetuned_StepInfo}
\end{table}

From the simulation it can be seen that both the reference controller and the auto-tuned controller as given by Astr\"om are much faster than the ones designed under decentralized assumptions or R2D2. This effect arises from the implementation of the AMIGO algorithm, which states that the delay $L_{ij}$ used for calculations is at least $0.3~T_{ij}$. Since the approximation of the system with an static inverse decoupler holds small time constant, $T_{11}^* = 8.330 \frac{1}{s}$ and $T_{22}^* = 9.880 \frac{1}{s}$, the process itself is faster and can use the original delay. Opposed to this, the decentralized controller and the R2D2 based controller compute the parameter based on the real time constants, which are much larger, and use a minimum delay. Therefore they perform poorly with respect to the other controller.\\

Another effect caused by this inequality can be observed from the rejection behavior of $y_1$. The faster controller causes and reduces the overshoot in less time than the relative dynamic decoupled controller.\\

However, the induced disturbance of both decoupled controllers on the outputs $\ve{y}$ is much less than the effects caused by the reference controller.  Additionally, both controller outperform the decentralized architecture with respect to tracking performance and the reference with respect to overshoot.\\


In Fig.\ref{c:fotd:s:woodberry:f:SingValNotDetuned} the effect on overall tracking and rejection performance is given by the singular values of the complementary sensitivity and sensitivity function. All processes show similar properties regarding bandwidth and maximum singular values of the sensitivity. Here both the decentralized controller and the static inverse decoupled controller outperform the proposed splitter architecture.

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Woodberry_NotDetuned_SV.svg}
\caption{Singular values of the sensitivity (red) and complementary sensitivity (green) function of Wood-Berry's binary distillation column without detuning}
\label{c:fotd:s:woodberry:f:SingValNotDetuned}
\end{figure}

A clear distinction is given in terms of the relative difference between the upper and lower bounds of the singular values, which is a measure for the evenly distributed maneuverability of the outputs. As shown before, the R2D2 controller distributes tracking and sensitivity much more even than the other controller. With respect to this fact, it can be seen that the both decentralized and static inversely decoupled control enable the steering of an output while the sensitivities upper bound outperforms the other. Hence, the usefulness of these frequency ranges are arguable.\\

Next, the simulation of the detuned system is shown in Fig.\ref{c:fotd:s:woodberry:f:SimDetuned} accompanied by the performance evaluation in Tab.\ref{c:fotd:s:woodberry:tab:eval2}. The R2D2 controller already acts within the dictated limits of interaction, while the performance of the controller as computed by AStr\"om has decreased dramatically.

%\begin{table}[H]
%\centering
%\caption{Evaluation of tracking performance and disturbance rejection performance of Wood-Berry's binary distillation column with detuning}
%\label{c:fotd:s:woodberry:tab:eval2}
%\input{./Graphics/Woodberry_Detuned_StepInfo}
%\end{table}

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Woodberry_Detuned.svg}
\caption{Simulation of Wood-Berry's binary distillation column with detuning}
\label{c:fotd:s:woodberry:f:SimDetuned}
\end{figure}

While both decoupler outperform the RGA, the splitter clearly dominates the controller decoupled via static inverse in the overall performance. Since the slowness of the controller is originating directly from the lower bound on the delay for computation, a less conservative bound would increase the performance and interaction.\\

Fig. \ref{c:fotd:s:woodberry:f:SingValDetuned} shows the singular value band of the processes.  Due to the detuning the usable bandwidth of the Astr\"om controller has decreased while the complementary sensitivity is behaving like the decentralized controller.\\

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{Woodberry_Detuned_SV.svg}
\caption{Singular values of the sensitivity (red) and complementary sensitivity (green) function of Wood-Berry's binary distillation column with detuning}
\label{c:fotd:s:woodberry:f:SingValDetuned}
\end{figure}

To conclude the evaluation of the process, both advantages and disadvantages of the decoupling controller can be noted. With a system varying in dynamics and sign of the gain, the effective system due to an approximation is able to be controlled more aggressively. This is shown by the not detuned controller decoupled by a static inverse, which assumes faster process on the main diagonal with a slower disturbance acting as interconnections. Due to this effect, the R2D2 is outperformed. However, if an upper limitation on the interaction is given, the advantages of evenly distributed dynamics are clearly visible. The limitation on the interaction has been adhered without detuning the controller.\\

\newpage

\section{McAvoy et. al.}%
\label{c:fotd:s:mcavoy}

The system in the following subsection has been introduced by REFERENz and reused for theoretical research since, e.g. REFERENZ INTERACTION. It is given by the following transfer function matrix:


\begin{figure}[H]\centering
\includesvg[width = \textwidth]{McAvoy_NotDetuned.svg}
\caption{Simulation of McAvoy's system without detuning}
\label{c:fotd:s:mcavoy:f:SimNotDetuned}
\end{figure}

\begin{table}[H]
\centering
\caption{Evaluation of tracking performance and disturbance rejection performance of McAvoy's system without detuning}
\label{c:fotd:s:mcavoy:tab:eval1}
\input{./Graphics/mcavoy_NotDetuned_StepInfo}
\end{table}

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{McAvoy_NotDetuned_SV.svg}
\caption{Singular values of the sensitivity (red) and complementary sensitivity (green) function of  McAvoy's system without detuning}
\label{c:fotd:s:mcavoy:f:SingValNotDetuned}
\end{figure}

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{McAvoy_Detuned.svg}
\caption{Simulation of McAvoy's system with detuning}
\label{c:fotd:s:mcavoy:f:SimDetuned}
\end{figure}

\begin{table}[H]
\centering
\caption{Evaluation of tracking performance and disturbance rejection performance of McAvoy's system with detuning}
\label{c:fotd:s:mcavoy:tab:eval1}
\input{./Graphics/mcavoy_Detuned_StepInfo}
\end{table}

\begin{figure}[H]\centering
\includesvg[width = \textwidth]{McAvoy_Detuned_SV.svg}
\caption{Singular values of the sensitivity (red) and complementary sensitivity (green) function of  McAvoy's system with detuning}
\label{c:fotd:s:mcavoy:f:SingValDetuned}
\end{figure}

\section{Identified System at WP 2}%
\label{c:fotd:s:wp1}

Working point 2

\section{Performance Review} % (fold)
\label{c:fotd:s:performance_review}

\begin{figure}[H]
\begin{minipage}[b]{\textwidth}
\centering
\includegraphics[width=0.9\textwidth]{./Graphics/Step_MATLAB.png}
\caption{Step of the MIMO}
\label{c:fotd:f:mimo_step}
\end{minipage}
\end{figure}

