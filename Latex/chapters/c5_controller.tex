%!TEX root = ../studentischeArbeiten.tex
\chapter{Multivariable PI/PID Controller Design}%
\label{c:controller}

Chapter \ref{c:controller} gives an overview about basic concepts used in the context of this work. The fundamentals can be found in the literature already mentioned in Ch.\ref{c:control}. Additional information on process control and especially PID control is given in \cite{Astrom1995} and \cite{Astrom2006}. The concepts of decoupling control are explained in great detail in \cite{Wang2006}.\\

The chapter starts in Sec. \ref{c:controller:s:AMIGO} with a brief explanation of the tuning rules used to derive the parameter set of the controller. \\

Afterwards a method to evaluate the input output coupling in multivariable process models is explained in Sec.\ref{c:controller:s:rga}. Some interesting properties are explained in detail.\\

In Sec.\ref{c:controller:s:decoupling} the key concept of this work is explained. Starting by introducing a method presented in \cite{Astrom2001a} and developing it to an equivalent, but more useful representation, the design of decoupled control loops is given. \\

\section{AMIGO Tuning Rules} % (fold)
\label{c:controller:s:AMIGO}

Many rules to design proportional-integral-derivative controller exist \cite[p.158 ff.]{Astrom2006}. The most famous set of rules has been developed by Ziegler and Nichols. Other rules, such as Cohen-Coon, can be named as well. The simple set of rules, derived by experimental procedures, have since then been reused for several tuning approaches \cite[p.169]{Astrom2006}. Other, analytical methods e.g. Pole Placement or Haalman's Method exists as well, but require a detailed model of the process.  In \cite[p.206 ff.]{Astrom2006} a robust loop shaping based on optimization has been introduced. A key concept is illustrated by the robustness region of a given process, depending on the controllers parameter set and the constrain in form of a maximum sensitivity. These optimization process lead to the M constrained Integral Gain Optimization (MIGO) method \cite[p.217]{Astrom2006}, an iterative algorithm calculating the needed parameter values.
The Approximate MIGO (AMIGO) tuning rules have been introduced in \cite[p.225 ff.]{Astrom2006}. They are derived by applying the MIGO algorithm to a test batch while demanding $M_S = 1.4$ . All processes of the test batch are approximated by a sufficiently analogous model, namely a integrating process with delay, a FOTD model , as described in Sec.\ref{c:identification:s:fotd} and a second order model. \\

The investigation of the optimization results can be condensed into the following set of equations for a simple proportional-integral controller based on a FOTD model approximation:

\begin{align}
\begin{split}
K_P &= \frac{0.15}{\hat{K}}+ \left(0.35 - \frac{\hat{L}~\hat{T}}{\left( \hat{L}+\hat{T} \right)^2} \right) \frac{\hat{T}}{\hat{K}~\hat{L}} \\
T_I &= 0.35~ \hat{L} + \frac{13~\hat{L}~\hat{T}^2}{\hat{T}^2 + 12~\hat{L}~\hat{T}+7 \hat{L}^2}
\end{split}
\label{c:controller:e:amigo_pi}
\end{align}

Eq.\ref{c:controller:e:amigo_pi} defines the proportional gain of the controller $K_P \in \mathbb{R}$ and the integral time $T_I \in \mathbb{R}$.\\

Additionally, the optimal calculated parameter of a proportional-integral-derivative controller are formulated as

\begin{align}
\begin{split}
K_P &= \frac{1}{\hat{K}} \left( 0.2 + 0.45~ \frac{\hat{T}}{\hat{L}}\right)\\
T_I &= \frac{0.4~\hat{L}+0.8~\hat{T}}{\hat{L}+0.1~\hat{T}}\hat{L}\\
T_D &= \frac{0.5~\hat{L}~\hat{T}}{0.3~\hat{L}+\hat{T}}
\end{split}
\label{c:controller:e:amigo_pid}
\end{align}

Eq.\ref{c:controller:e:amigo_pid} introducing the derivative Time $T_D \in \mathbb{R}$.\\

The AMIGO rules presented above hold several properties described in \cite[p.229 ff.]{Astrom2006}. Important advice in the context of this work is given in form of a recommendation for set-point weighting \cite[p.229 f., p.235 ff.]{Astrom2006} and a drawback with respect to lag dominance \cite[p.231 ff.]{Astrom2006}.\\ 

In \cite[p.253 ff.]{Astrom2006} the detuning process is described. Since detuning is an essential element of the overall design procedure, as shown later, the method will be explained here. It is used if the controller is acting to fast and hence producing unwanted overshoot. To reduce this effect, the controller parameter need to be scaled to smaller values while ensuring the stability. Therefore an algorithm describing the adjustment of the gains with respect to each other is needed.\\

Based on the maximum sensitivity the following dimensionless factors are defined 

\begin{align}
\begin{split}
\alpha_D &= \frac{M_S-1}{M_S}\\
\beta_D &= M_S \frac{M_S+\sqrt{M_S^2 -1}}{2} 
\end{split}
\label{c:controller:e:amigo_factor}
\end{align}

Eq. \ref{c:controller:e:amigo_factor} defines the factors needed for calculating the new value of the integral gain $K_I = \frac{K_P}{T_I}$ according to

\begin{align}
\begin{split}
K_I^{i+1} &= \begin{cases}
	K_I^i \frac{\alpha_D + K_P^{i+1} \hat{K}}{\alpha_D + K_P^{i} \hat{K}} ~, K_P^{i+1} \hat{K} \geq \frac{K_I^{i}\hat{K}\left(\hat{L}+\hat{T}\right)}{\beta_D \left( \alpha_D + K_P^{i+1} \hat{K}\right)} - \alpha_D\\
	\beta_D \frac{\left( \alpha_D + K_P^{i+1} \hat{K} \right)^2}{\hat{K} \left( \hat{L}+ \hat{T} \right)}~, K_P^{i+1} \hat{K} < \frac{K_I^{i}\hat{K}\left(\hat{L}+\hat{T}\right)}{\beta_D \left( \alpha_D + K_P^{i+1} \hat{K}\right)} - \alpha_D\\
\end{cases}
\end{split}
\label{c:controller:e:amigo_detune}
\end{align} 

Eq.\ref{c:controller:e:amigo_detune} is derived by investigating the robustness of a FOTD sysem in dependence of the parameter of the controller and approximation of the same.\\

\section{Interaction Measures of Multivariable Processes} % (fold)
\label{c:controller:s:rga}

Current controller design in the problem set of this work is mostly relying on the assumption that the system is behaving like an assembly of single input single output processes. It is based not on holistic approaches but on calculating the parameter solely with regards to the current loop. To choose the right pairing of in- and outputs resembling with a maximal dominance over the output the relative gain array (RGA) has been introduced by \cite{Bristol1966}. Other measurements and indicators, like the Hankel Singular Values, Hankel Interaction Indexes or the Participation Matrix, have been developed as well, see e.g. QUELLEN. The RGA however is used intensively in industry and described in literature \cite[p. 88 ff.]{Skogestad2005}, \cite[p.219 ff.]{Glad2000}. The RGA is defined as

\begin{align}
\begin{split}
\Lambda\left(\ma{G}\right) &= \ma{G} \circ \ma{G}^{-T}
\end{split}
\label{c:controller:e:rga}
\end{align}

The RGA $\Lambda:\mathbb{C}^{n_y \times n_y},\mathbb{C}^{n_y \times n_y} \mapsto \mathbb{C}^{n_y \times n_y}$ as defined in Eq.\ref{c:controller:e:rga} is given by the hadamard product of the transfer function matrix and its transposed inverse. It can be interpreted as a ratio between open loop control and closed loop control \cite[p.221]{Glad2000}. Most commonly, the RGA is computed in the steady state of the system, but the elements near the crossover frequency give likewise useful information. To illustrate this, consider a simple system with a steady state gain and its inverse given by

\begin{align}
\begin{split}
\left|\ma{G}|_{s=0}\right| &= \begin{bmatrix}
2 & -1 \\
5 & 10
\end{bmatrix} \\
\left| \ma{G}|_{s=0}^{-1} \right| &= \frac{1}{25} \begin{bmatrix}
10 & 1 \\
-5 & 2
\end{bmatrix}
\end{split}
\end{align}

The corresponding RGA is given by:

\begin{align}
\begin{split}
\Lambda(\ma{G}) &= \begin{bmatrix}
2 & -1 \\
5 & 10
\end{bmatrix} ~\frac{1}{25} \begin{bmatrix}
10 & 1 \\
-5 & 2
\end{bmatrix}^T \\
&= \frac{1}{25}~\begin{bmatrix}
2 & -1 \\
5 & 10
\end{bmatrix} ~ \begin{bmatrix}
10 & -5 \\
1 & 2
\end{bmatrix} \\
&= \frac{1}{25} \begin{bmatrix}
20 & 5 \\
5 & 20
\end{bmatrix}\\
&= \begin{bmatrix}
0.8 & 0.2 \\
0.2 & 0.8
\end{bmatrix}
\end{split}
\end{align}

Which indicates a pairing of the main diagonals, since the matrix is diagonal dominant. In other terms, the system in closed loop control will behave nearly like the open loop control system. To discuss the RGA at crossover frequency, assume the system is in reality described by:

\begin{align}
\ma{G}(s) = \begin{bmatrix}
\frac{2}{s +1} & \frac{5s-1}{s +1} \\
\frac{5}{s +1} & \frac{10}{s +1}
\end{bmatrix}
\end{align}

The gain crossover frequency of MIMO systems is defined as the first frequency at which any of the transfer functions crosses the unit gain, or equivalently zero dB, from above \cite[p.37]{Skogestad2005}. Assuming normalized gains $k_{ij}= 1$ holds that $\omega_C = \min(\frac{1}{T_{ij}})$for any pure lag systems. Hence, the estimated crossover frequency of above system is $\omega_C \approx 1$. The systems gain and its inverse is given by the complex matrices:

\begin{align}
\begin{split}
\left|\ma{G}|_{s=j}\right| &= \frac{1}{j+1} \begin{bmatrix}
2 & 5j-1 \\
5 & 10
\end{bmatrix} \\
\left| \ma{G}|_{s=j}^{-1} \right| &\approx \begin{bmatrix}
0.000 & 0.200 \\
0.000 & 0.000
\end{bmatrix} + j~\begin{bmatrix}
0.400 & 0.040 \\
0.200 & 0.080 
\end{bmatrix}
\end{split}
\end{align}

The complex valued RGA of the system at the given frequency computes to be:\\

\begin{align}
\Lambda(\ma{G}|_{s=j}) = \begin{bmatrix}
0.400 & 0.600 \\
0.600 & 0.400 
\end{bmatrix}
+ j~\begin{bmatrix}
0.400 & -0.400 \\
-0.400 & 0.400
\end{bmatrix}
\end{align}

Which indicates a cross pairing over the minor diagonal of the system, since the real parts of the matrix are dominant.\\

Interesting properties of the RGA can be found in literature, eg. \cite{Skogestad2005}, \cite{Astrom1995}, \cite{Astrom2006}. However, the connection between the condition number $\kappa_C:~\mathbb{R},\mathbb{R} \mapsto \mathbb{R}$ and the RGA explained in \cite[p.88 f.]{Skogestad2005} is worth noticing. The condition number is given as

\begin{align}
\begin{split}
\kappa_C &= \frac{\overline{\sigma}(\ma{G})}{\underline{\sigma}(\ma{G})} \\
&= \overline{\sigma}(\ma{G}) \overline{\sigma}(\ma{G}^{-1})
\end{split}
\label{c:controller:e:condtion_number}
\end{align}

with the $\underline{\sigma} = \min(\sigma)$ being the lower bound of the singular values of a transfer function matrix. Eq.\ref{c:controller:e:condtion_number} can be interpreted as an index for the balance, meaning the ratio of the biggest and smallest possible gain, of a process. Furthermore, it can be interpreted as a measure of equivalence between the input-output relationship represented by the transfer function matrix. Hence, very large or very small condition numbers are not desirable and indicate a very poor performance. It can be minimized using scaling matrices best to be chosen by physical meaningful interpretations \cite[p.87]{Skogestad2005}. The sum norm of the RGA, meaning the sum over all elements of $\Lambda(\ma{G})$, is close to this minimal realizable value. Hence, large elements of the RGA indicate an ill-conditioned process.\\ 

Investigating the RGA leads to several conclusions about the optimal pairing of inputs and outputs. A selection with respect to this work is presented in the following.\\

If the elements of the RGA are large around the crossover frequency, a decoupler or inverse based controller should not be used \cite[p. 89]{Skogestad2005}, where large is corresponding to values $\geq 10$. Here the robustness to the uncertainty of inputs is not given \cite[p.243]{Skogestad2005}. If an element of the RGA calculated around steady state is negative, the decentralized controller tend towards instability \cite[p.90, p.447]{Skogestad2005}. \pagebreak

\section{Decoupling of Multivariable Processes} % (fold)
\label{c:controller:s:decoupling}

Designing controller for multivariable processes has inevitable challenges. Since a general MIMO plant consists of a main coupling, represented in the main diagonal of the transfer function matrix, and cross coupling given by the minor elements of the transfer function function matrix. An illustration of this problem is given in FIG. where both forward and backward coupling is pictured in a block diagram.\\

\begin{figure}[h]
\begin{minipage}[t]{0.45\textwidth}
\includesvg[width = \textwidth]{Graphics/Coupling_Forward}
\caption{Coupling in P-canonic structure}
\label{c:controller:f:pcanon}
\end{minipage}%
\hspace{0.05\textwidth}
\begin{minipage}[t]{0.45\textwidth}
\includesvg[width = \textwidth]{Graphics/Coupling_Backward}
\caption{Coupling in V-canonic structure}
\label{c:controller:f:vcanon}
\end{minipage}
\end{figure}


By closing a feedback loop a connection between these two elements is made out of necessity. Hence, the overall performance and robustness of a closed loop is influenced by the cross couplings between the inputs and outputs. To achieve better results regarding these two major aspects of the control paradigm, several techniques can be used solely or in combination to reduce the influence of the minor diagonal entries.\\


\subsection{Decoupling Control proposed by Astr\"om et.al.}
\label{c:controller:sub:astrom}

A method for the design of decoupling controllers is proposed in \cite{Astrom2001a} and \cite{Astrom2006}. A diagonal controller $\ma{K}^*$ which limits the interaction near the steady state of the plant within certain limitations is designed. To achieve this behavior a decoupler $\ma{D} \in  \mathbb{R}^{n_y \times n_y}$ is introduced. A static decoupling is proposed such that $\ma{D} = \ma{G}^{-1}|_{s=0}$ that transforms the system with the mapping $\ma{G} \ma{D} = \ma{G}^* \in \mathbb{R}^{n_y \times n_y}$. Since the decoupler is defined to be the inverse of the steady state gain, the steady state of the transformed system is given by the identity matrix $\ma{I} \in \mathbb{R}^{n_y \times n_y}$. The block diagram of the decoupled system is given in Fig.\ref{c:controller:f:decoupledsystem}.

\begin{figure}[h!]
\centering
\includesvg[width = .8\textwidth]{Graphics/Decoupled_System}
\caption{Block diagram of the decoupled system}
\label{c:controller:f:decoupledsystem}
\end{figure}

The resulting closed loop of the transformed system with a setpoint controller $\ma{K}_r$ and a feedback controller $\ma{K}_y$ is given by: 

\begin{align}
\begin{split}
\ma{H} &=  \left[ \ma{I}  - \ma{G} \ma{K}_y \right]^{-1} \ma{G} \ma{K}_r \\
&= \left[ \ma{I}  - \ma{G} \ma{D} \ma{K}_y^* \right]^{-1} \ma{G} \ma{D} \ma{K}_r^* \\
	 &= \left[ \ma{I}  - \ma{G}^* \ma{K}_y^* \right]^{-1} \ma{G}^* \ma{K}_r^*
\end{split}
\label{c:controller:e:closedloopastrom}
\end{align}
\nomenclature{$\ma{H}$}{Closed Loop Transfer Function}

Eq. \ref{c:controller:e:closedloopastrom} gives various important transformations between the controller and system of the original identified system and the new transformed system.The diagonal controller $\ma{K}^*$, designed based on the decoupled system $\ma{G}^*$ is connected to the controller of the original system via $\ma{K}^* = \ma{D} \ma{K}$.\\ 

A Taylor series around the steady state of the  transformed system is given by:

\begin{align}
\begin{split}
\ma{G}^* &= \sum_{i=0}^\infty \frac{d^i}{ds^i} \ma{G}^* |_{s=0} \frac{s}{i!} \\
&= \ma{I} + s \ma{\Gamma}^* + \ma{\mathcal{O}}\left(s^2\right) \\
&\approx \ma{I} +  \ma{\Gamma}^* s \\
&\approx \ma{I} + \left( \ma{\Gamma}^*_D + \ma{\Gamma}^*_A \right) s
\end{split}
\label{c:controller:e:taylor}
\end{align}

In Eq.\ref{c:controller:e:taylor} the coupling for small frequencies can be described via the coupling matrix $\ma{\Gamma}^* = \left( \gamma_{ij}^* \right)\in \mathbb{R}^{n_y \times n_y}$. The matrix consists both of diagonal and anti diagonal entries $\ma{\Gamma}^* = \ma{\Gamma}^*_D + \ma{\Gamma}^*_A$ which describes the small signal behavior of the system, represented by the first order of the series sufficiently.\\

Substitute Eq.\ref{c:controller:e:taylor} in the numerator of Eq. \ref{c:controller:e:closedloopastrom} holds:

\begin{align}
\begin{split}
\ma{H} &\approx \left[ \ma{I}  - \ma{G}^* \ma{K}_y^* \right]^{-1} \left[ \ma{I} +  \ma{\Gamma}^* s \right] \ma{K}_r^* \\
  &\approx \left[ \ma{I}  - \ma{G}^* \ma{K}_y^* \right]^{-1} \left[ \ma{I} + \left( \ma{\Gamma}^*_D + \ma{\Gamma}^*_A \right) s\right] \ma{K}_r^* \\
\end{split}
\end{align}

The anti diagonal entries are given by

\begin{align}
\begin{split}
\ma{H}_A &\approx \left[ \ma{I}  - \ma{G}^* \ma{K}_y^* \right]^{-1} \left[\ma{\Gamma}_A^* s \right] \ma{K}_r^*
\end{split}
\end{align}

According to \cite{Astrom2001a}, every entry of the matrix $\ma{H}_A = (h_{ij})~\forall i \neq j \in \mathbb{R}^{n_y \times n_y} $ simplifies to:

\begin{align}
\begin{split}
|h_{ij}| &= \left|\left(\prod_{k = 1}^{n_y} S_{k}^*\right)\gamma_{ij}^*s ~k^*_{r,jj} \right| \\
\end{split}
\label{c:controller:e:interaction}
\end{align}

Where $k^*_{r,jj}$ is the j-th entry of the diagonal controller used for the reference signal $\ma{K}_r^*$, weighted by the product of the sensitivities $S_k^*$ of all control loops . Eq. \ref{c:controller:e:interaction} can be used to describe the interconnections of the system and therefore the influence of each controller due to the couplings.\\

Next, an upper limit $h_{ij,Max}^* \geq |h_{ij}^*| \in \mathbb{R}^+$ which describes the maximal allowed or desired interaction between the j-th input and the i-th output is introduced. Typical values for the upper bound are in the range $\left[0.1, 0.5\right]$. Since the steady state of the transformed system is given by the identity matrix, $h_{ij,Max}$ can be interpreted as a relative error in output caused by the cross coupling, i.e. the anti diagonal entries of the system. \\

For the special case where $k^*_{r,jj}$ is a pure integrator $k_{r,jj}^* = \frac{k_{I,jj}^*}{s}$ Eq. \ref{c:controller:e:interaction} becomes:

\begin{align}
\begin{split}
\left| h_{ij} \right| &= \left|\left(\prod_{k = 1}^{n_y} S_k^*\right) \gamma^*_{ij}~ k^*_{I,jj} \right| \\
& \leq \left|\left(\prod_{k = 1}^{n_y} M_{S,k}^*\right) \gamma^*_{ij}~ k^*_{I,jj} \right| \\
& \leq \left|h_{ij,max}\right|
\end{split}
\label{c:controller:e:setpointinteraction}
\end{align}

The relation given by Eq. \ref{c:controller:e:setpointinteraction} gives a condition for detuning a purely integral controller. Since not every controller is given in this form, the structure is extended to PI control with set-point-weight by:

\begin{align}
\begin{split}
\left|h_{ij}\right| &\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^* s \left(b~k_{P,jj}^* + k_{I,jj}^* \frac{1}{s} \right) \right| \\
&\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^*\right| \left|\left(b~k_{P,jj}^* s+ k_{I,jj}^* \right) \right| \\
&\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^*\right| \left|\left(b~k_{P,jj}^* j\omega+ k_{I,jj}^* \right) \right| \\
&\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^*\right| \sqrt{\left(b~k_{P,jj}^*\omega\right)^2+ \left(k_{I,jj}^*\right)^2} \\
\end{split}
\label{c:controller:e:TransformedPIDetuning}
\end{align}

While Eq.\ref{c:controller:e:setpointinteraction} describes a relation for a pure integrator transferring the set-point signal into the systems input,this is not a general notion. In Eq.\ref{c:controller:e:TransformedPIDetuning} the influence of the proportional controller is increasing with the frequency and thus the interaction. Adding a derivative term to the equation leads to further frequency related increases of the interaction. Since \cite{Astrom2001a} focuses purely on the special case $b=0$, a practical solution for the frequency dependence is proposed.\\

To detune the controller sufficiently, an adequate frequency must be chosen. In \cite[p.172 f.]{Skogestad2005} the crossover frequency of a pure time delay transfer function is limited by an upper bound

\begin{align}
\omega_C &\leq \frac{1}{L}
\label{c:controller:e:DelayCrossover}
\end{align}

Eq. \ref{c:controller:e:DelayCrossover} states that the crossover frequency is inversely proportional to the delay of a system. From a practical point of view, systems with a high delay have a very limited bandwidth and can only be controlled properly near the steady state. For a more general system,it is not practical to rely only on the delay for determination of the upper boundary of the frequency. Imagine a process with a small normalized time delay and an induced high first order dynamics. The crossover frequency is dominated by the time constant $T$, meaning $\omega_c \approx \frac{1}{T} \ll \frac{1}{L}$. This assumptions relies on the behavior of the gain of a lag dominant n-th order model which is monotonic decreasing with $-3 \frac{dB}{dec}$ for frequency $\omega \geq \frac{1}{T}$. To ensure a robust detuning, another bound needs to be established.\\

Since the detuning process relies on the first order approximation of the process via a Taylor series around $s=0$, a bound can be found by ensuring the frequency dependent dominance of the expression. This is given as long as the second order terms are small in relation to the first order:

\begin{align}
\begin{split}
\left|(T+L)~s \right| &\geq \left| \left[(T^2 + L^2) + T^2 \right] \frac{s^2}{2} \right|\\
\left| s \right| & \leq 2 \left| ~\frac{T+L}{(T^2+L^2)+T^2} \right| \\
\omega_C & \leq 2 \left| ~\frac{T+L}{(T^2+L^2)+T^2} \right| \\
\end{split}
\label{c:controller:e:SecondOrderBound}
\end{align}

The statement given by Eq. \ref{c:controller:e:SecondOrderBound} relates the crossover frequency to the both delay and time constant of the system. If the delay of a system is small, $L \to 0$ than the corresponding crossover frequency corresponds to $\omega_C \to \frac{1}{T}$, which is identical to a simple first order process. To ensure a robust detuning, the frequency used is multiplied by a safety factor $R \in \left[1,2\right]$, since the RHS of Eq. \ref{c:controller:e:TransformedPIDetuning} is monotonically increasing in $\omega$. A graphical interpretation of the reasoning above is given in FIG\\

HIER FIG\\

Likewise to Eq.\ref{c:controller:e:TransformedPIDetuning} the interaction for a PID controller with set-point-weight can be estimated with:

\begin{align}
\begin{split}
\left|h_{ij}\right| &\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^* s \left(b~k_{P,jj}^* + k_{I,jj}^* \frac{1}{s} + b_D~k_{D,jj}^*~s \right) \right| \\
&\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^*\right| \left|\left(b~k_{P,jj}^* s+ k_{I,jj}^*+ b_D ~k_{D,jj}^*~s^2  \right) \right| \\
&\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^*\right| \left|\left(b~k_{P,jj}^* j\omega+ k_{I,jj}^*+ b_D ~k_{D,jj}^*~(j\omega)^2  \right) \right| \\
&\leq \left| \left(\prod_k M_{S,k} \right) \gamma_{ij}^*\right| \sqrt{\left(b~k_{P,jj}^*\omega\right)^2+ \left(k_{I,jj}^*- b_D ~k_{D,jj}^*~\omega^2\right)^2} \\
\end{split}
\label{c:controller:e:TransformedPIDDetuning}
\end{align}


From Eq. \ref{c:controller:e:TransformedPIDDetuning}, where $b_D \in \lbracket 0,1 \rbracket$ denotes the set-point-weight of the derivative gain of the controller, it is obvious that the derivative gain reduces the impact of the integral gain with respect to the frequency. Hence, for larger $\omega$ the effect of the derivative gain is of much more importance.\\

Eq. \ref{c:controller:e:setpointinteraction},\ref{c:controller:e:TransformedPIDetuning} and \ref{c:controller:e:TransformedPIDDetuning} can be rewritten in matrix form $\ma{H}_{Max} = \left(h_{ij,Max}\right) \in \mathbb{R}^{n_y \times n_y}$ and the matrix of the maximum sensitivities of the diagonal transfer functions $\ma{M}_S^* = \left(M_{S,i}^*\right) \in \mathbb{R}^{n_y \times n_y}$. Using the definition of the maximum sensitivity matrix as diagonal, one can rewrite $\prod_k M_{S,k}^* = \det(\ma{M}_S) $. Once again dividing into a diagonal and anti diagonal matrix holds:

\begin{align}
\begin{split}
\ma{H}_{A,Max} &\geq \det(\ma{M}_S^*)~\ma{\Gamma}_A^*s~ \ma{K}_{r,Max}^* 
\end{split}
\label{c:controller:e:Hmax*}
\end{align}

Eq. \ref{c:controller:e:Hmax*} can be used to detune with the given interaction. In \cite[p.357]{Astrom2006} a more progressive approach is given. Following the assumption of a sufficiently decoupled process, the matrix of sensitivity functions is nearly diagonal. Hence, the \ref{c:controller:e:interaction} can be rewritten to:

\begin{align}
\left|h_{ij} \right| = S_i^* \gamma_{ij}^*s~k_{r,jj}^*
\label{c:controller:e:ProgressiveInteraction}
\end{align}

Which induces Eq.\ref{c:controller:e:Hmax*} to change to be

\begin{align}
\begin{split}
\ma{H}_{A,Max} &\geq \ma{M}_S^*~ \ma{\Gamma}_A^*s~ \ma{K}_{r,Max}^* 
\end{split}
\label{c:controller:e:ProgressiveHmax*}
\end{align}

Good results on classic theoretical examples, e.g. Rosenbrocks System, can be produced and are shown in Ch.\ref{c:fotd}. However, the method has certain drawbacks. The design procedure requires a permanent decoupling, using weighted linear combinations of the controller outputs as system inputs. This is linked to a robust signal transportation. Furthermore, the transformed system in general not the proposed model structure of a FOTD system, meaning either the linear combination has to be approximated as a FOTD or the collected data of the experiments has to be reused. Since a decoupler is not in every case needed nor wanted, an immense effort designing the algorithm has to be done. Gain Scheduling for a controller would require the diagonal controller and the decoupler to be manipulated.\\

Imagine the systems gain to be perturbed by a relative error written as $\ma{\delta} \in \mathbb{C}^{n_y \times n_y}$. The nominal process $\ma{\hat{G}}$, on which the decoupler is based, can be written as the real process $\ma{G}$ multiplied by a scaling matrix:

\begin{align}
\begin{split}
\ma{\hat{G}} &= \left( \ma{I} - \ma{\delta} \right) \ma{G}
\end{split}
\label{c:controller:e:PertubedGain}
\end{align}

Assuming the error is small in relation to the real process, the maximum singular value of the relative error is bounded by $\overline{\sigma}(\ma{\delta}) < 1$. Hence, the inverse of the nominal process model can be written as

\begin{align}
\begin{split}
\ma{\hat{G}}^{-1} &= \ma{G}^{-1} \left( \ma{I} - \ma{\delta} \right)^{-1} \\
&= \ma{G}^{-1} \sum_{i=0}^\infty \ma{\delta}^i  \\
&= \ma{G}^{-1} + \ma{G}^{-1} \ma{\delta} + \ma{G}^{-1}\ma{\delta}^2 + \dots
\end{split}
\label{c:controller:e:InversePertubedGain}
\end{align}

Eq.\ref{c:controller:e:InversePertubedGain} uses the Neumann Series QUELLE to estimate the matrix inverse. Depending on the quality of measurements which result in the pertubation of the matrix, the matrix inverse can vary largely. To illustrate this, the process gain given in REF is pertubed the following:

\begin{align}
\begin{split}
\ma{\hat{G}}|_{s=0} &= \begin{bmatrix} 
1.05 & -0.05 \\
0.05 & 1.05
\end{bmatrix}
\begin{bmatrix}
2 & -1 \\
5 & 10
\end{bmatrix} \\
&= \begin{bmatrix}
1.85 & -1.55 \\
5.35 & 10.45
\end{bmatrix}
\end{split}
\label{c:controller:e:PertubedExample}
\end{align}

Its inverse can be computed to

\begin{align}
\ma{\hat{G}}|_{s=0}^{-1} = \begin{bmatrix}
0.35 & 0.06  \\
-0.19 & 0.07
\end{bmatrix}
\end{align}

Multiplying this with the real system gives:

\begin{align}
\begin{split}
\ma{\hat{G}}|_{s=0}^{-1} \ma{G} &= \begin{bmatrix}
1.04 & 0.18 \\
-0.05 & 0.86
\end{bmatrix}
\end{split}
\label{c:controller:PertubedMultiply}
\end{align}

From Eq.\ref{c:controller:PertubedMultiply} it is visible that even small changes can make a significant difference in the solution of the inversion. Here an error of 18 percent is given on the influence of the main diagonal.\\



\subsection{A Modified Controller Design Based on Astr\"om et.al. - Robust Relative Dynamic Decoupling}
\label{c:controller:sub:modified}

To enable the use of the original system, reducing the influence of perturbation and to increase the robustness of the process, another strategy is presented in the following subsection. Building upon the idea of detuning the first order dynamics of the system, as proposed by \cite{Astrom2001a} and \cite{Astrom2006}, and utilizing mathematical relationships the decoupler is transformed into another form feasible of smoothly enable and disable a decoupling. Furthermore, under certain assumptions the original transfer function model can be used to design the controller. Additionally the detuning process is modified to detune not for the relative gain of the cross couplings, but for the relative process dynamics of the open loop.\\

First, a decoupler similar to the one presented in Subs.\ref{c:controller:sub:astrom} can be deduced. Investigating the product of a matrix multiplication holds: 

\begin{align}
\begin{split}
\ma{G}^{A} \ma{G}^{B} &= 
\begin{bmatrix}
\ma{G}_{11}^{A} & \ma{G}_{12}^{A} \\
\ma{G}_{21}^{A} & \ma{G}_{22}^{A} 
\end{bmatrix}
\begin{bmatrix}
\ma{G}_{11}^{B} & \ma{G}_{12}^{B} \\
\ma{G}_{21}^{B} & \ma{G}_{22}^{B} 
\end{bmatrix}\\
&= \begin{bmatrix}
\ma{G}_{11}^{A}\ma{G}_{11}^{B} + \ma{G}_{12}^{A}\ma{G}_{21}^{B} & \ma{G}_{11}^{A}\ma{G}_{12}^{B} + \ma{G}_{12}^{A}\ma{G}_{22}^{B} \\
\ma{G}_{21}^{A}\ma{G}_{11}^{B} + \ma{G}_{22}^{A}\ma{G}_{21}^{B} &
\ma{G}_{21}^{A}\ma{G}_{12}^{B} + \ma{G}_{22}^{A}\ma{G}_{22}^{B}
\end{bmatrix}
\end{split}
\label{c:controller:e:matrixmult}
\end{align}

Eq. \ref{c:controller:e:matrixmult} states that the diagonal elements are the sum of two products that either consist of pure diagonal or pure anti-diagonal entries. Anti-diagonal entries are always the mixed product of diagonal and anti-diagonal terms. Via a sufficient interchanging of rows and columns, every matrix can be ordered, such that the main coupling transfer functions are on the diagonal.\\

Starting with the relation between the transformed, purely diagonal controller $\ma{K}^*$ of the transformed system $\ma{G}^*$ , the  diagonal and anti-diagonal entries of the resulting dense controller $\ma{K}$ can be identified:

\begin{align}
\begin{split}
\ma{D}\ma{K}^* &= \ma{K} \\
\left(\ma{D}_D + \ma{D}_A \right) \ma{K}^* &= \left(\ma{K}_D + \ma{K}_A \right)\\
\left(\ma{D}_D + \ma{D}_A \right) \ma{D}^{-1} \ma{K} &= \left(\ma{K}_D + \ma{K}_A \right)
\end{split}
\label{c:controller:e:eqscontroller}
\end{align}

Eq. \ref{c:controller:e:eqscontroller} relates the diagonal controller $\ma{K}_D \in \mathbb{C}^{n \times n}$ designed via the diagonal transfer functions $g^*_{ii}$ to the decoupling controller as stated in \cite{Astrom2001a} . Since $\ma{K}^{*}$ is diagonal a direct relationship between the anti-diagonal elements of the controller can be established by using the results of Eq.\ref{c:controller:e:matrixmult}:

\begin{align*}
\begin{split}
\ma{K}_A &= \ma{D}_A \ma{K}^* 
\end{split}
\end{align*}

Using the transformation $\ma{K}^* = \ma{D}^{-1} \left( \ma{K}_D + \ma{K}_A \right)$ holds the two relationships \textbf{MICHAEL HAT ANMERKUNG MIT ANDEREN FORMELN -> DISKUSSION}:

\begin{align*}
\ma{K}_A &= \ma{D}_A \ma{D}^{-1} \left( \ma{K}_D + \ma{K}_A \right) \\
\ma{K} &= \ma{D}\ma{D}_A^{-1} \ma{K}_A
\end{align*}

Next, the relation between the diagonal controller $\ma{K}_D$ and the anti-diagonal controller $\ma{K}_A$ based on the considerations made above is established:

\begin{align}
\begin{split}
\ma{K}_A &= \ma{K} - \ma{K}_D \\
&= \ma{D}\ma{D}_A^{-1} \ma{K}_A - \ma{K}_D \\
&= \left[\ma{D}\ma{D}_A^{-1} - \ma{I}  \right]^{-1} \ma{K}_D\\
&= \ma{\Sigma} \ma{K}_D
\end{split}
\label{c:controller:e:splitter}
\end{align}

Eq. \ref{c:controller:e:splitter} defines the splitter $\ma{\Sigma} \in \mathbb{R}^{n \times n}$ which can substitute the anti diagonal controller in Eq.\ref{c:controller:e:eqscontroller}:

\begin{align}
\begin{split}
\ma{D} \ma{K}^* &= \left[ \ma{I} + \ma{\Sigma} \right] \ma{K}_D
\end{split}
\label{c:controller:e:controleqs}
\end{align}

HIER EVTL Ã„NDERUNG! \textbf{The splitter is already a known tool for decoupling, as given in \cite[p.190 ff.]{Wang2006} explicitly defined in \cite[p.193 Eq.(6.19)]{Wang2006}.} With further investigating the matrix relation given by Eq.\ref{c:controller:e:controleqs}, the splitter can be simplified to:

\begin{align*}
\begin{split}
\ma{\Sigma} &= \left[\ma{D}\ma{D}_A^{-1} - \ma{I}  \right]^{-1} \\
&= \left[\left(\ma{D}_D + \ma{D}_A\right)\ma{D}_A^{-1} - \ma{I}  \right]^{-1} \\
&= \left[\ma{D}_D \ma{D}_A^{-1} + \ma{I} - \ma{I}  \right]^{-1}\\
&= \left[\ma{D}_D \ma{D}_A^{-1}\right]^{-1}\\
&= \ma{D}_A \ma{D}_D^{-1}\\
\end{split}
\end{align*}


An interesting property of the splitter is the intuitive relation between the main diagonal entries of the system and the anti diagonal entries. Since we can invert a block sufficient conditioned block matrix via:

\begin{align}
\begin{split}
\begin{bmatrix}
\ma{G}_{11} & \ma{G}_{12} \\
\ma{G}_{21} & \ma{G}_{22} 
\end{bmatrix}^{-1} &= \begin{bmatrix}
\left[\ma{G}_{11} - \ma{G}_{12}\ma{G}_{22}^{-1}\ma{G}_{22}\right]^{-1} & -\ma{G}_{11}^{-1}\ma{G}_{12}\left[\ma{G}_{22} - \ma{G}_{21}\ma{G}_{11}^{-1}\ma{G}_{12}\right]^{-1}  \\
-\ma{G}_{22}^{-1}\ma{G}_{21}\left[\ma{G}_{11} - \ma{G}_{12}\ma{G}_{22}^{-1}\ma{G}_{21}\right]^{-1}  & \left[\ma{G}_{22} - \ma{G}_{12}\ma{G}_{11}^{-1}\ma{G}_{12}\right]^{-1} 
\end{bmatrix} \\
\end{split}
\end{align}

The splitter given by $\ma{D}_A\ma{D}_D^{-1}$ becomes in the notation above
\begin{align}
\begin{split}
\ma{\Sigma} &= \begin{bmatrix}
0 & -\ma{G}_{11}^{-1}\ma{G}_{12}\\
-\ma{G}_{22}^{-1}\ma{G}_{21}  & 0
\end{bmatrix}
\end{split}
\label{c:controller:e:EasySplitter}
\end{align}

Next, the relation between the controller given by the RGA, $\ma{K}_{\Lambda}$, is investigated. Assume the relation is given by:

\begin{align}
\begin{split}
\ma{G}\ma{D}\ma{K}^* &= \ma{G} \left[ \ma{I} + \ma{\Sigma}\right] \ma{W} \ma{K}_D \\
&= \ma{G}_D \ma{K}_{\Lambda}
\end{split}
\label{c:controller:e:SplitterRGARelation}
\end{align}

Eq.\ref{c:controller:e:SplitterRGARelation} states that there exists a weighting matrix $\ma{W} \in \mathbb{C}^{n_y \times n_y}$ such that the diagonal controller $\ma{K}_D$ and $\ma{K}_{\Lambda}$ are equal. Solving for the weight holds:

\begin{align}
\begin{split}
\ma{W} &= \left[ \ma{I}+\ma{\Sigma}\right]^{-1} \ma{G}^{-1} \ma{G}_D \\
&= \left[  \ma{I}+\ma{\Sigma} \right]^{-1} \left[\ma{G}_D + \ma{G}_A \right]^{-1} \ma{G}_D \\  
&= \left[  \ma{I}+\ma{\Sigma} \right]^{-1} \left[\ma{I} + \ma{G}_D^{-1}\ma{G}_A \right]^{-1} \\
&= \left[  \ma{I}+\ma{\Sigma} \right]^{-1} \left[  \ma{I} - \ma{\Sigma} \right]^{-1}
\end{split}
\label{c:controller:e:PerfectDecoupling}
\end{align}

Eq.\ref{c:controller:e:PerfectDecoupling} gives the perfect decoupler for the system, as given in HIER QUELLEN!. However, since ideal dynamic decoupling requires a precise model, this approach is neglected. Instead, the assumption of a nearly decoupled system is made by setting $\ma{W}=\ma{I}$, hence setting:

\begin{align}
\ma{K}_D = \ma{K}_{\Lambda}
\end{align} 

Which holds the relative error in dynamics given by:

\begin{align}
\begin{split}
\ma{G}_D^{-1}\left[\ma{G}_D^*- \ma{G}_D\right] &= \ma{G}_D^{-1}\left[\ma{G}_D + \ma{G}_A \ma{\Sigma} - \ma{G}_D \right]\\
&= \ma{G}_D^{-1}\ma{G}_A \ma{\Sigma} 
\end{split}
\label{c:controller:e:relativedynamicerror}
\end{align}

From Eq.\ref{c:controller:e:relativedynamicerror} the relative error dynamics are given in terms of the splitter. Another way to interpret the error is by giving a complex scalar error $\Delta_D \in \mathbb{C}$:

\begin{align}
\begin{split}
\Delta_D \ma{G}_D &\geq   \ma{G}_A \ma{\Sigma} \\
\Delta_D \det\left( \ma{G}_D \right) &\geq \det\left( \ma{G}_A \ma{\Sigma} \right) \\
\Delta_D &\geq \frac{\det\left( \ma{G}_A \ma{\Sigma} \right) }{\det\left( \ma{G}_D \right)}
\end{split}
\label{c:controller:e:complexerror}
\end{align}

Hence, by Eq.\ref{c:controller:e:complexerror} we have an upper bound as well as an indicator for the usefulness. Assuming diagonal dominance requires the splitter to be small, hence the error is neglectable.\\

It is clearly visible that the splitter weights the minor with the main diagonals. It can be connected both to feedforward control and disturbance rejection by dividing the system as shown in Fig.\ref{c:controller:f:splitter_disturbance} and Fig.\ref{c:controller:f:splitter_feedforward}. Since the used model used for the estimation of the couplings is crude, a feed forward architecture is better suited since the real delay of the system is not known. Hence, a disturbance rejection based upon a smith predictor would most likely result in an uncontrollable system due to the model error.\\

\begin{figure}[h]
\begin{minipage}[t]{0.45\textwidth}
\includesvg[width = \textwidth]{Graphics/Splitter_Disturbance}
\caption{Interpretation of the splitter within the disturbance rejection framework}
\label{c:controller:f:splitter_disturbance}
\end{minipage}%
\hspace{0.05\textwidth}
\begin{minipage}[t]{0.45\textwidth}
\includesvg[width = \textwidth]{Graphics/Splitter_Feedforward}
\caption{Interpretation of the splitter within the feed forward compensation framework}
\label{c:controller:f:splitter_feedforward}
\end{minipage}
\end{figure}


\begin{figure}[h]
\centering
\includesvg[width = 0.6\textwidth]{Graphics/Splitter_TITO}
\caption{Compensator implementation of the splitter in a two input two output system}
\label{c:controller:f:splitter_tito}
\end{figure}


Next on the sensitivity of a system designed with and without a decoupling splitter is investigated. Assuming the non decoupled system is less robust, the following relationship holds:

\begin{align}
\ma{S}_{\Lambda} \geq \ma{S}^*
\end{align}

Where $\ma{S}_{\Lambda}$ is the systems sensitivity due to a simple, decentralized controller based on the RGA and $\ma{S}^*$ is the decoupled systems sensitivity, given by use of the splitter. Starting from the reasoning given in \cite[p.443 ff.]{Skogestad2005}, the relative magnitude of the off diagonal elements of the transfer function matrix are given by $\ma{E} \in \mathbb{C}^{n_y \times n_y}$:

\begin{align}
\ma{E} = \left[ \ma{G} - \ma{G}_D \right]\ma{G}_D^{-1}
\label{c:controller:e:InteractionMagnitude}
\end{align}

Assuming that magnitude of the set-point controller is always less or equal to the feedback controller $\left|\ma{K}_R \right|\leq \left|\ma{K}_Y\right|$, the relation of the magnitude of the complementary sensitivity is given by $\left|\ma{T}\right| = \left|ma{G} \ma{K}_R \right| \leq \left|\ma{G} \ma{K}_Y\right|$ and thus $\left|\ma{T}\right| \leq \left|\ma{S} - \ma{I}\right| $. Hence, a prove of robustness is sufficient for the case $\left|\ma{T}\right| = \left|\ma{S} - \ma{I}\right|$. Furthermore following \cite[p.443]{Skogestad2005}, factorization of the Sensitivity holds:

\begin{align}
\begin{split}
\ma{S}^{-1} &=\underbrace{\left[\ma{I} - \ma{E} \ma{T}_D \right]}_{\text{Interconnections}} ~ \underbrace{\left[ \ma{I} - \ma{G}_D \ma{K}_D \right]}_{\text{Individual loops}} 
\end{split}
\label{c:controller:e:RobustFactorization}
\end{align}

Hence, the difference between the nominal stability of the diagonal controller is dependent on the factor representing the interconnections given in terms of the complementary sensitivity $\ma{T}_D = \ma{S}_D - \ma{I} $. The sensitivity function is therefore given as the inverse of Eq. \ref{c:controller:e:RobustFactorization}:

\begin{align}
\ma{S} = \ma{S}_D \left[\ma{I} - \ma{E} \ma{T}_D \right]^{-1}
\label{c:controller:e:SensitivityClosedLoop}
\end{align}

To be able to fulfill the stability conditions in terms of the maximum singular value, Eq. \ref{c:controller:e:SensitivityClosedLoop} needs both the diagonal sensitivity $\ma{S}_D =  \ma{I} - \ma{G}_D \ma{K}_D$ and the factor $\ma{I} - \ma{E} \ma{T}_D$ are both stable. Hence, the general Nyquist theorem requires:

\begin{align}
\overline{\sigma}(\ma{E}\ma{T}_D) < 1
\end{align}

Assuming that the controller is tuned for $\ma{T}_D \leftarrow \ma{I}$, it can be deduce that:

\begin{align}
\begin{split}
\overline{\sigma}(\ma{E}\ma{T}_D) &= \overline{\sigma}(\ma{E})~\overline{\sigma}(\ma{T}_D) \\
&\approx \overline{\sigma}(\ma{E}) \\
\overline{\sigma}(\ma{E}) &\leq 1
\end{split}
\label{c:controller:e:RobustnessDiagonalDom}
\end{align}

Eq. \ref{c:controller:e:RobustnessDiagonalDom} can be interpreted the following: If the system is only diagonal, the diagonal sensitivity is equal to the real sensitivity. If couplings are involved, the system will be amplified if the wrong input-output pairings are chosen. The smaller the magnitude of the anti-diagonal described by $\ma{E}$, the more robustness is given. Since Eq.\ref{c:controller:e:InteractionMagnitude} with the use of a splitter becomes:

\begin{align}
\begin{split}
\ma{E} &= \left[ \ma{G} \left(\ma{I}+\ma{\Sigma}\right)- \ma{G}_D \right]\ma{G}_D^{-1} \\
&= \left[\ma{G}-\ma{G}_D + \ma{G}\ma{\Sigma}\right]\ma{G}_D^{-1} \\
&= \left[\ma{G}_A + \ma{G}_D \ma{\Sigma}+\ma{G}_A \ma{\Sigma}\right]\ma{G}_D^{-1} \\
&= \left[\ma{G}_A - \ma{G}_A +\ma{G}_A \ma{\Sigma}\right]\ma{G}_D^{-1} \\
&= \ma{G}_A \ma{\Sigma}\ma{G}_D^{-1} \\
&= -\ma{G}_A\ma{G}_D^{-1}\ma{G}_A\ma{G}_D^{-1} \\
&= - \ma{\Sigma}^2
\end{split}
\label{c:controller:SplitterMagnitude}
\end{align}

Which is an indicator for the usefulness of the splitter. Eq.\ref{c:controller:SplitterMagnitude} gives a relation between the diagonal process model used for designing the controller and the anti-diagonal entries of the transfer function matrix. For using a static decoupler which leads to all entries of the matrices being real, the maximum singular value is only greater than one iff the singular values of the anti-diagonal parts of the system are greater than the ones of the diagonal transfer functions.\\

To illustrate this, lets assume a simple, static transfer function and its RGA given by:

\begin{align*}
\ma{G} = \begin{bmatrix}
1 & 1.2 \\
0.1 & 5
\end{bmatrix}, \Lambda(\ma{G}) = \begin{bmatrix}
1.025 & -0.025 \\
-0.025 & 1.025
\end{bmatrix}
\end{align*}

Obviously, the main diagonal entries are preferred pairings. Investigating the magnitude of the of diagonal with respect to the main diagonal gives:

\begin{align*}
\ma{E} = \left[ \begin{bmatrix}
1 & 1.2 \\ 0.1 & 5
\end{bmatrix} - \begin{bmatrix}
1 & 0 \\ 0 & 5
\end{bmatrix} \right]\begin{bmatrix}
1 & 0 \\ 0 & \frac{1}{5}
\end{bmatrix} = \begin{bmatrix}
0 & 0.24 \\ 0.1 & 0
\end{bmatrix} 
\end{align*}

And its maximum singular value $\overline{\sigma} = 0.24$. Note that in general the maximum singular value is not equal to any entries of the matrix but since this special case is given by a rotated diagonal matrix, the singular values can be directly seen. Now lets slowly increase the matrix by a gain $K \in \mathbb{R}^+$ acting on the transfer function between input 1 and output 2:

\begin{align*}
\ma{G} = \begin{bmatrix}
1 & 1.2 \\
K & 5
\end{bmatrix}
\end{align*}

And suppose the pairing is staying the same. The interaction gain will be given by:

\begin{align*}
\ma{E} = \begin{bmatrix}
0 & 0.24 \\
K & 0 \\
\end{bmatrix}
\end{align*}

Hence, the maximum singular value will be given as

\begin{align*}
\overline{\sigma}(\ma{E}) = \begin{cases}
0.24 , ~K \leq 0.24 \\
K, ~K > 0.24
\end{cases}
\end{align*}

We can see that the maximum singular value will destabilize the system iff it exceeds value for $K \geq 1$. However, using a decoupler holds for the Eq.\ref{c:controller:SplitterMagnitude}:

\begin{align*}
\begin{split}
\ma{E} &= - \begin{bmatrix}
0 & 1.2 \\
1 & 0 
\end{bmatrix}\begin{bmatrix}
1 & 0 \\ 0 & \frac{1}{5}
\end{bmatrix}\begin{bmatrix}
0 & 1.2 \\
1 & 0 
\end{bmatrix}\begin{bmatrix}
1 & 0 \\ 0 & \frac{1}{5}
\end{bmatrix} \\
&= -  \begin{bmatrix}
0 & 0.24 \\
1 & 0 
\end{bmatrix}\begin{bmatrix}
0 & 0.24 \\ 1 & 0
\end{bmatrix} \\
&= -\begin{bmatrix}
0 & 0.24 \\ 0.24 & 0
\end{bmatrix}
\end{split}
\end{align*}

Hence, the robustness is increased, since the maximum singular value is not exceeding one. The maximum value for the gain while using the splitter can be estimated roughly as $K \approx 4.167$. Applying this knowledge to the process, one can argue that the maximum sensitivity of the closed loop in presence of a decoupler is decreased, which can already be guessed by Eq. \ref{c:controller:e:SensitivityClosedLoop}. Hence, a a progressive detuning like Eq.\ref{c:controller:e:ProgressiveHmax*}, since we are much more likely that $\ma{E} \ll \ma{I}$, and hence the diagonal sensitivity is equal to the real sensitivity. Also, the use of a setpoint-weight increases the robustness as well, since it decreases the magnitude of the open loop gain.\\ 

Since a detuned interaction is wanted, the approximation of the process dynamics via the first order terms of the Taylor Series is used as well. Explicitly the term is given by:

\begin{align}
\begin{split}
\ma{\Gamma}_A &= \left[\frac{d}{ds}\left[ \ma{G} \left[ \ma{I} + \ma{\Sigma} \right] \right]|_{s=0}\right]_A\\
&= \frac{d}{ds}\left[ \ma{G}_A + \ma{G}_D \ma{\Sigma} \right]|_{s=0}
\end{split}
\label{c:controller:e:TaylorSplitterAntidiagonal}
\end{align}

Further investigation of term given in Eq. \ref{c:controller:e:TaylorSplitterAntidiagonal} reveals the dependency on the average residence time. Using a decoupler build upon the steady state, the first order dynamics are:

\begin{align}
\begin{split}
\ma{\Gamma}_A &= \frac{d}{ds}\left[ \ma{G}_A + \ma{G}_D \ma{\Sigma} \right]|_{s=0} \\
&= \left[ \ma{G}_{A,0}~\circ~\ma{T}_{AR,A} + \left(\ma{G}_{D,0}~\circ~\ma{T}_{AR,D} \right) \ma{\Sigma} \right] \\
&= \left[ \ma{G}_{A,0}~\circ~\ma{T}_{AR,A} - \ma{G}_A~\circ~\ma{T}_{AR,D}  \right] \\
&= \ma{G}_{A,0}~\circ~\left[ \ma{T}_{AR,A} - \ma{T}_{AR,D}\right]
\end{split}
\label{c:controller:e:TaylorSplitterDynamics}
\end{align}

With $\ma{T}_{AR} = (T_{ar,ij}) = (T_{ij} + L_{ij})\in \mathbb{R}^{n_y \times n_y}$ being the matrix consisting of the average residence times of the single transfer functions $g_{ij}$ of the process. The operator $\circ$ is the Hadamard Product and stands for the element-wise multiplication. Note that normally, the Hadamard Product is not distributive over multiplication. But since the splitter can be written as a product of a rotation matrix $\ma{O}$ and a diagonal matrix $\ma{\Sigma}_D$, $\ma{\Sigma} = \ma{\Sigma}_D \ma{0} $, it is possible. From Eq. \ref{c:controller:e:TaylorSplitterDynamics} we can see that the first order dynamics acting on the output are related to the difference in the dynamics of the main diagonal and the anti-diagonal terms. This coincides with the statements of e.g. LUNZE, where a static decoupling is described to be able to decouple the dynamics if the dynamic behavior of the process are alike. Using this knowledge, the goal of the detuning can be reformulated to change the controller in such a way that the dynamic behavior of the output is nearly equivalent to the dynamics of the main coupling. \\

Hence, we relate both dynamics with each other to find the relative dynamic interaction of the process $\ma{\Gamma}_R \in \mathbb{R}^{n_y \times n_y}$:

\begin{align}
\begin{split}
\ma{\Gamma}_R &= \left| \ma{\Gamma}_D^{-1}~\ma{\Gamma}_A  \right|\\
&= \left| \left[\ma{G}_{D,0}~\circ~\ma{T}_{AR,D}\right]^{-1} \ma{G}_{A,0}~\circ~\left[ \ma{T}_{AR,A} - \ma{T}_{AR,D}\right] \right|
\end{split}
\label{c:controller:e:RelativeDynamicDifference}
\end{align}

Eq.\ref{c:controller:e:RelativeDynamicDifference} can be used as a measure of the relative difference between the main coupling on the diagonal and the interaction dynamics. It includes the gain as well, so if the difference in dynamics is high but the gain of the anti-diagonal is small in relation to the diagonal, the process is nearly decoupled. Likewise a high difference of the gains in presence of roughly identical dynamics will have no impact on the process.\\

With the maximum allowed relative dynamic interaction and sensitivities the detuning formula is explicitly given by:

\begin{align}
\begin{split}
\ma{H}_{A,Max} &\geq \ma{M}_S \ma{\Gamma}_R \ma{K}_r \\ 
&\geq \det(\ma{M}_S) \ma{\Gamma}_R \ma{K}_r 
\end{split}
\end{align}

Good limits for the upper bound $\ma{H}_{A,Max} = \left( h_{ij,Max}\right) \in \mathbb{R}^{n_y \times n_y}$ are within the set of $\left[0.1 \dots 0.5 \right]$ to ensure the process dynamics are roughly the same.

\section{Review of the Methods}\label{c:controller:s:review}

While being mathematical equivalent, both algorithms diverge with regards to design principles and can be used very differently. Astr\"oms original method uses a decoupled system to derive an optimal controller. The modified variant is able to build upon a controller designed by the original system. Hence, either the RGA can be used as a starting point or a naturally pairing, e.g. valve and pressure, can be build upon. This is illustrated by Fig. \\.

HIER FIG.\\

The method proposed in Subs. \ref{c:controller:sub:astrom} gives many advantages over a controller design simply based on RGA while holding the number of integrators minimal. The enhancement of performance comes through the interconnection of the controller outputs via the decoupler, which can be viewed as a simple form of model based control. Whilst giving major performance improvements, the presented method has a significant disadvantages.\\

Depending on the model chosen for identification and the values of the coefficients, the resulting transfer function will in general be of other form than the initial identified model. Hence, algorithms depending on these models to design controllers can not be used naturally, but have to use a simplified or approximated model. This process results in a higher model error and thus in poor performance and robustness of the derived controller.\\

Hence, an application of the splitter as introduced in Subs.\ref{c:controller:sub:modified} can be used to derive a similar representation while using the original identified functions. An illustrative example will be given in the following chapter pointing to the advantages of the process. In \cite{Wang2006} several properties of the splitter are investigated and a design algorithm is given. It can be related to both feed forward control and disturbance rejection control architecture, which allows for usage of either the error in delay dominant systems or for calculating a corrected input from the output for lag dominant systems.

